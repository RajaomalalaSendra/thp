<!DOCTYPE html>
<html class="loading" lang="fr">
  <head>
<script>window.NREUM||(NREUM={});NREUM.info={"beacon":"bam.nr-data.net","errorBeacon":"bam.nr-data.net","licenseKey":"ea4c9be856","applicationID":"130952841","transactionName":"IFYPQUNbWApXFE1WBRBRA1pQRlBJVgcbQUsQUQ5C","queueTime":4,"applicationTime":268,"agent":""}</script>
<script>window.NREUM||(NREUM={}),__nr_require=function(e,n,t){function r(t){if(!n[t]){var o=n[t]={exports:{}};e[t][0].call(o.exports,function(n){var o=e[t][1][n];return r(o||n)},o,o.exports)}return n[t].exports}if("function"==typeof __nr_require)return __nr_require;for(var o=0;o<t.length;o++)r(t[o]);return r}({1:[function(e,n,t){function r(){}function o(e,n,t){return function(){return i(e,[c.now()].concat(u(arguments)),n?null:this,t),n?void 0:this}}var i=e("handle"),a=e(3),u=e(4),f=e("ee").get("tracer"),c=e("loader"),s=NREUM;"undefined"==typeof window.newrelic&&(newrelic=s);var p=["setPageViewName","setCustomAttribute","setErrorHandler","finished","addToTrace","inlineHit","addRelease"],d="api-",l=d+"ixn-";a(p,function(e,n){s[n]=o(d+n,!0,"api")}),s.addPageAction=o(d+"addPageAction",!0),s.setCurrentRouteName=o(d+"routeName",!0),n.exports=newrelic,s.interaction=function(){return(new r).get()};var m=r.prototype={createTracer:function(e,n){var t={},r=this,o="function"==typeof n;return i(l+"tracer",[c.now(),e,t],r),function(){if(f.emit((o?"":"no-")+"fn-start",[c.now(),r,o],t),o)try{return n.apply(this,arguments)}catch(e){throw f.emit("fn-err",[arguments,this,e],t),e}finally{f.emit("fn-end",[c.now()],t)}}}};a("actionText,setName,setAttribute,save,ignore,onEnd,getContext,end,get".split(","),function(e,n){m[n]=o(l+n)}),newrelic.noticeError=function(e,n){"string"==typeof e&&(e=new Error(e)),i("err",[e,c.now(),!1,n])}},{}],2:[function(e,n,t){function r(e,n){if(!o)return!1;if(e!==o)return!1;if(!n)return!0;if(!i)return!1;for(var t=i.split("."),r=n.split("."),a=0;a<r.length;a++)if(r[a]!==t[a])return!1;return!0}var o=null,i=null,a=/Version\/(\S+)\s+Safari/;if(navigator.userAgent){var u=navigator.userAgent,f=u.match(a);f&&u.indexOf("Chrome")===-1&&u.indexOf("Chromium")===-1&&(o="Safari",i=f[1])}n.exports={agent:o,version:i,match:r}},{}],3:[function(e,n,t){function r(e,n){var t=[],r="",i=0;for(r in e)o.call(e,r)&&(t[i]=n(r,e[r]),i+=1);return t}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],4:[function(e,n,t){function r(e,n,t){n||(n=0),"undefined"==typeof t&&(t=e?e.length:0);for(var r=-1,o=t-n||0,i=Array(o<0?0:o);++r<o;)i[r]=e[n+r];return i}n.exports=r},{}],5:[function(e,n,t){n.exports={exists:"undefined"!=typeof window.performance&&window.performance.timing&&"undefined"!=typeof window.performance.timing.navigationStart}},{}],ee:[function(e,n,t){function r(){}function o(e){function n(e){return e&&e instanceof r?e:e?f(e,u,i):i()}function t(t,r,o,i){if(!d.aborted||i){e&&e(t,r,o);for(var a=n(o),u=v(t),f=u.length,c=0;c<f;c++)u[c].apply(a,r);var p=s[y[t]];return p&&p.push([b,t,r,a]),a}}function l(e,n){h[e]=v(e).concat(n)}function m(e,n){var t=h[e];if(t)for(var r=0;r<t.length;r++)t[r]===n&&t.splice(r,1)}function v(e){return h[e]||[]}function g(e){return p[e]=p[e]||o(t)}function w(e,n){c(e,function(e,t){n=n||"feature",y[t]=n,n in s||(s[n]=[])})}var h={},y={},b={on:l,addEventListener:l,removeEventListener:m,emit:t,get:g,listeners:v,context:n,buffer:w,abort:a,aborted:!1};return b}function i(){return new r}function a(){(s.api||s.feature)&&(d.aborted=!0,s=d.backlog={})}var u="nr@context",f=e("gos"),c=e(3),s={},p={},d=n.exports=o();d.backlog=s},{}],gos:[function(e,n,t){function r(e,n,t){if(o.call(e,n))return e[n];var r=t();if(Object.defineProperty&&Object.keys)try{return Object.defineProperty(e,n,{value:r,writable:!0,enumerable:!1}),r}catch(i){}return e[n]=r,r}var o=Object.prototype.hasOwnProperty;n.exports=r},{}],handle:[function(e,n,t){function r(e,n,t,r){o.buffer([e],r),o.emit(e,n,t)}var o=e("ee").get("handle");n.exports=r,r.ee=o},{}],id:[function(e,n,t){function r(e){var n=typeof e;return!e||"object"!==n&&"function"!==n?-1:e===window?0:a(e,i,function(){return o++})}var o=1,i="nr@id",a=e("gos");n.exports=r},{}],loader:[function(e,n,t){function r(){if(!E++){var e=x.info=NREUM.info,n=l.getElementsByTagName("script")[0];if(setTimeout(s.abort,3e4),!(e&&e.licenseKey&&e.applicationID&&n))return s.abort();c(y,function(n,t){e[n]||(e[n]=t)}),f("mark",["onload",a()+x.offset],null,"api");var t=l.createElement("script");t.src="https://"+e.agent,n.parentNode.insertBefore(t,n)}}function o(){"complete"===l.readyState&&i()}function i(){f("mark",["domContent",a()+x.offset],null,"api")}function a(){return O.exists&&performance.now?Math.round(performance.now()):(u=Math.max((new Date).getTime(),u))-x.offset}var u=(new Date).getTime(),f=e("handle"),c=e(3),s=e("ee"),p=e(2),d=window,l=d.document,m="addEventListener",v="attachEvent",g=d.XMLHttpRequest,w=g&&g.prototype;NREUM.o={ST:setTimeout,SI:d.setImmediate,CT:clearTimeout,XHR:g,REQ:d.Request,EV:d.Event,PR:d.Promise,MO:d.MutationObserver};var h=""+location,y={beacon:"bam.nr-data.net",errorBeacon:"bam.nr-data.net",agent:"js-agent.newrelic.com/nr-1118.min.js"},b=g&&w&&w[m]&&!/CriOS/.test(navigator.userAgent),x=n.exports={offset:u,now:a,origin:h,features:{},xhrWrappable:b,userAgent:p};e(1),l[m]?(l[m]("DOMContentLoaded",i,!1),d[m]("load",r,!1)):(l[v]("onreadystatechange",o),d[v]("onload",r)),f("mark",["firstbyte",u],null,"api");var E=0,O=e(5)},{}]},{},["loader"]);</script>
    <meta name="viewport" content="width=device-width, user-scalable=no">
    <title>Le tableau de bord | The Hacking Project</title>
<meta name="description" content="Ici c&#39;est ton tableau de bord, tu y trouves les infos li√©s √† ton compte, √† ta progression dans la formation et a ta moyenne.">
<meta property="og:site_name" content="The Hacking Project">
<meta property="og:title" content="Le tableau de bord">
<meta property="og:url" content="https://www.thehackingproject.org/">
<meta property="og:description" content="The Hacking Project est une √©cole en peer-learning gratuite, sans locaux, sans s√©lection. L&#39;enseignement est compos√© int√©gralement de projets en √©quipe.">
<meta property="og:image" content="https://www.thehackingproject.org/assets/home-1-342ac3a7b4986c9b25b30b9dfc4b83dafeed398ee2bc61c660aa04f6e7cef81f.jpg">

<meta name="csrf-param" content="authenticity_token" />
<meta name="csrf-token" content="uvNpIt74enjOqhy1MBZSJ8mD/0PDV2a7cFuOmS5wtRY1jhNmJ1dk5dnQj1AmU8Oe+T6DS/UkuS394piJcf0rpA==" />
<link rel="apple-touch-icon" sizes="180x180" href="/assets/favicon/apple-touch-icon-c01aaccf467f7cc3d79bbce743d60779f5b833fdc4500cebd07a5e11a07a5c31.png">
<link rel="icon" type="image/png" sizes="32x32" href="/assets/favicon/favicon-32x32-804b12d1c41c60fe721477b7c3b0a32811dc610580dd40ac92f1cc04cbd05ca4.png">
<link rel="icon" type="image/png" sizes="16x16" href="/assets/favicon/favicon-16x16-d96ba65e5785d32474df9ebc6fbfd5442c751d527b10981a474bc3b7a4079d01.png">
<link rel="manifest" href="/assets/favicon/manifest-cf975201fd8ac78a1f1a203357573d50031f1cc33436d099743df6428b8a38a2.json">
<link rel="mask-icon" href="/assets/favicon/safari-pinned-tab-8af1cfcf7525ccdccb490f9f5adad396653a4969b419e0a9a9d3a1088140a912.svg" color="#5bbad5">
<link rel="shortcut icon" href="/assets/favicon/favicon-cbf10361dc90b277565960736d4897fddef5468bff6299811ea9498459d56d21.ico">
<meta name="msapplication-config" content="/assets/favicon/browserconfig-dab38db6040ef54ac56e91fdd77e3d7b06746a634e87b68c99b59b216cb8611a.xml">
<meta name="theme-color" content="#ffffff">

<link rel="stylesheet" media="screen" href="/packs/vendor-539cdbdee74ba7fbe9c2cefa4bf9abe2.css" />
<link rel="stylesheet" media="screen" href="/packs/dashboard-20fb2c0f53a2b62c3efa7cf6f1e3e589.css" />
<!-- Global site tag (gtag.js) - Google Analytics -->
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-105991867-1"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', 'UA-105991867-1');
</script>
<!-- End Google Analytics -->

<!-- Facebook Pixel Code -->
    <script>
        !function(f,b,e,v,n,t,s)
        {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
        n.callMethod.apply(n,arguments):n.queue.push(arguments)};
        if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
        n.queue=[];t=b.createElement(e);t.async=!0;
        t.src=v;s=b.getElementsByTagName(e)[0];
        s.parentNode.insertBefore(t,s)}(window,document,'script',
        'https://connect.facebook.net/en_US/fbevents.js');
         fbq('init', '773401719499556');
        fbq('track', 'PageView');
    </script>
    <noscript>
     <img height="1" width="1"
    src="https://www.facebook.com/tr?id=773401719499556&ev=PageView
    &noscript=1"/>
    </noscript>
<!-- End Facebook Pixel Code -->

<!-- start Mixpanel -->
<script type="text/javascript">(function(c,a){if(!a.__SV){var b=window;try{var d,m,j,k=b.location,f=k.hash;d=function(a,b){return(m=a.match(RegExp(b+"=([^&]*)")))?m[1]:null};f&&d(f,"state")&&(j=JSON.parse(decodeURIComponent(d(f,"state"))),"mpeditor"===j.action&&(b.sessionStorage.setItem("_mpcehash",f),history.replaceState(j.desiredHash||"",c.title,k.pathname+k.search)))}catch(n){}var l,h;window.mixpanel=a;a._i=[];a.init=function(b,d,g){function c(b,i){var a=i.split(".");2==a.length&&(b=b[a[0]],i=a[1]);b[i]=function(){b.push([i].concat(Array.prototype.slice.call(arguments,
0)))}}var e=a;"undefined"!==typeof g?e=a[g]=[]:g="mixpanel";e.people=e.people||[];e.toString=function(b){var a="mixpanel";"mixpanel"!==g&&(a+="."+g);b||(a+=" (stub)");return a};e.people.toString=function(){return e.toString(1)+".people (stub)"};l="disable time_event track track_pageview track_links track_forms track_with_groups add_group set_group remove_group register register_once alias unregister identify name_tag set_config reset opt_in_tracking opt_out_tracking has_opted_in_tracking has_opted_out_tracking clear_opt_in_out_tracking people.set people.set_once people.unset people.increment people.append people.union people.track_charge people.clear_charges people.delete_user people.remove".split(" ");
for(h=0;h<l.length;h++)c(e,l[h]);var f="set set_once union unset remove delete".split(" ");e.get_group=function(){function a(c){b[c]=function(){call2_args=arguments;call2=[c].concat(Array.prototype.slice.call(call2_args,0));e.push([d,call2])}}for(var b={},d=["get_group"].concat(Array.prototype.slice.call(arguments,0)),c=0;c<f.length;c++)a(f[c]);return b};a._i.push([b,d,g])};a.__SV=1.2;b=c.createElement("script");b.type="text/javascript";b.async=!0;b.src="undefined"!==typeof MIXPANEL_CUSTOM_LIB_URL?
MIXPANEL_CUSTOM_LIB_URL:"file:"===c.location.protocol&&"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js".match(/^\/\//)?"https://cdn.mxpnl.com/libs/mixpanel-2-latest.min.js":"//cdn.mxpnl.com/libs/mixpanel-2-latest.min.js";d=c.getElementsByTagName("script")[0];d.parentNode.insertBefore(b,d)}})(document,window.mixpanel||[]);
mixpanel.init("3a34a32946b2ebf5b2063d502374f392");</script>
<!-- end Mixpanel -->

  <script>
    (function(h,o,t,j,a,r){
        h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
        h._hjSettings={hjid:995310,hjsv:6};
        a=o.getElementsByTagName('head')[0];
        r=o.createElement('script');r.async=1;
        r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
        a.appendChild(r);
    })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
  </script>

<script type="text/javascript">(function(o){var b="https://api.autopilothq.com/anywhere/",t="ccedc1a9b6b946929d14dce625b51c035665d4ea12e846308ede0db968e93f42",a=window.AutopilotAnywhere={_runQueue:[],run:function(){this._runQueue.push(arguments);}},c=encodeURIComponent,s="SCRIPT",d=document,l=d.getElementsByTagName(s)[0],p="t="+c(d.title||"")+"&u="+c(d.location.href||"")+"&r="+c(d.referrer||""),j="text/javascript",z,y;if(!window.Autopilot) window.Autopilot=a;if(o.app) p="devmode=true&"+p;z=function(src,asy){var e=d.createElement(s);e.src=src;e.type=j;e.async=asy;l.parentNode.insertBefore(e,l);};y=function(){z(b+t+'?'+p,true);};if(window.attachEvent){window.attachEvent("onload",y);}else{window.addEventListener("load",y,false);}})({});</script>



<link href="https://fonts.googleapis.com/css?family=Muli:300,300i,400,400i,600,600i,700,700i%7CComfortaa:300,400,700" rel="stylesheet">
  </head>
  <body class="vertical-layout vertical-menu 2-columns  menu-expanded fixed-navbar" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns">
    <script src="/packs/manifest-f83a0093dcd4ded5722b.js"></script>
    <script src="/packs/vendor-214b310486bb8bf723e4.js"></script>
        <nav class="header-navbar navbar-expand-md navbar navbar-with-menu navbar-without-dd-arrow fixed-top navbar-semi-light" style="padding:0;">
                    <div class="navbar-wrapper">
                      <div class="navbar-container content">
                        <div class="collapse navbar-collapse show" id="navbar-mobile">
                          <!-- Division Gauche -->
                          <ul class="nav navbar-nav mr-auto float-left">
                            <li class="nav-item mobile-menu d-md-none mr-auto"><a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#"><i class="ft-menu font-large-1"></i></a></li>
                            <li class="nav-item d-none d-md-block"><a class="nav-link nav-menu-main menu-toggle hidden-xs" href="#"><i class="ft-menu"></i></a></li>
                          </ul>
                          <!-- Fin division Gauche -->

                          <!-- Division Milieu-->

                          <!-- Fin division Milieu-->

                          <!-- Division droite -->
                          <ul class="nav navbar-nav float-right">

                           <li class="dropdown dropdown-user nav-item">
                            <a class="dropdown-toggle nav-link dropdown-user-link" href="#" data-toggle="dropdown">
                                <span class="avatar avatar-online">
                                  
<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="/packs/packs/dashboard/images/profile/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg" />

                                </span>

                            </a>
                              <div class="dropdown-menu dropdown-menu-right">
                                <div class="arrow_box_right">
                                  <a class="dropdown-toggle nav-link dropdown-user-link" href="/users/6776?locale=fr">
                                    <span class="avatar avatar-online pt-0">
                                      
<img alt="avatar" style="max-height: 40px!important; width: auto" class="rounded-circle img-border" src="/packs/packs/dashboard/images/profile/default_profile-a3318a5e66467f9958f16a172f9d15d6.jpg" />

                                    </span>
                                    <span class="user-name text-bold-700 ml-1 text-dark"> Sendra Andriampanjato</span>
</a>                                  <div class="dropdown-divider"></div>
                                  <a class="dropdown-item" href="/users/6776/edit?locale=fr">
                                    <i class="ft-edit"></i> Edit. profil</a>
</a>
                                  <a class="dropdown-item" href="/dashboard/assignments?locale=fr&amp;sort=mine">
                                     <i class="fa ft-award"></i> Mes missions
</a>                                  <div class="dropdown-divider"></div>

                                  <a class="dropdown-item" rel="nofollow" data-method="delete" href="/logout?locale=fr">
                                     <i class="ft-power"></i> D√©connexion
</a>

                                </div>
                              </div>
                            </li>
                          </ul>

                          <!-- Fin division Droite-->
                        </div>

                      </div>
                    </div>
                </li>
            </ul>

          <!-- Fin division Milieu-->

        </div>
      </div>
    </div>
</nav>


     <div class="main-menu menu-fixed menu-light menu-accordion    menu-shadow " data-scroll-to-active="true"
  data-img="/packs/packs/dashboard/images/background/02-5c429c538031754c55530f38b4635d03.jpg">
        <div class="navbar-header">
          <ul class="nav navbar-nav flex-row">
            <li class="nav-item mr-auto">
                <a class="navbar-brand" href="/fr">
                  <h3 class="brand-text">The Hacking Project</h3>
</a>             </li>
            <li class="nav-item d-md-none"><a class="nav-link close-navbar"><i class="ft-x"></i></a></li>
          </ul>
        </div>
        <div class="main-menu-content">
          <ul class="navigation navigation-main" id="main-menu-navigation" data-menu="menu-navigation">
            <li class=" nav-item">
              <a href="/dashboard?locale=fr">
                <!-- rollback to past commit because this wasn't working att all  -->
                <!--       link_to dashboard_week_day_path(Week.find_by_this_week(@session), Day.current_day_position)  do -->

                <i class="ft-monitor"></i>
                <span class="menu-title" data-i18n="">Aujourd'hui</span>
</a>            </li>


            <li class="nav-item">
              <a href="#">
                 <i class="fa ft-award"></i>
                <span class="menu-title" data-i18n="">Missions</span>
</a>                <ul class="menu-content">
                </ul>
              </li>

            <li class=" nav-item">
              <a href="#">
                 <i class="ft-users"></i>
                <span class="menu-title" data-i18n="">Groupe</span>
</a>                <ul class="menu-content">

                </ul>
              </li>
              <li class=" nav-item">
              <a href="#">
                 <i class="ft-camera"></i>
                <span class="menu-title" data-i18n="">Trombinoscope</span>
</a>                <ul class="menu-content">
<!--
                  <li><a class="menu-item" href="#">Ma promotion</a>
                  </li>
                  <li><a class="menu-item" href="#">Mon parrain</a>
                  </li> -->

                </ul>
              </li>
              <li class="nav-item">
                <a href="/dashboard/weeks?locale=fr">
                  <i class="fa fa-book"></i>
                  <span class="menu-title" data-i18n="">Programme</span>
</a>                <ul class='menu-content'>
                    <li><a href="/dashboard/weeks/1?locale=fr">Introduction au Code</a></li>
                    <li><a href="/dashboard/weeks/2?locale=fr">D√©couverte de Ruby</a></li>
                    <li><a href="/dashboard/weeks/3?locale=fr">Programmation Orient√©e Objet</a></li>
                    <li><a href="/dashboard/weeks/4?locale=fr">Initiation √† Rails</a></li>
                    <li><a href="/dashboard/weeks/5?locale=fr">Rails interm√©diaire</a></li>
                    <li><a href="/dashboard/weeks/6?locale=fr">Rails avanc√©</a></li>
                    <li><a href="/dashboard/weeks/7?locale=fr">HTML / CSS</a></li>
                    <li><a href="/dashboard/weeks/8?locale=fr">JavaScript de front</a></li>
                    <li><a href="/dashboard/weeks/9?locale=fr">Projet : boutique en ligne</a></li>
                    <li><a href="/dashboard/weeks/10?locale=fr">Projet Final 1</a></li>
                    <li><a href="/dashboard/weeks/11?locale=fr">Projet Final 2</a></li>
                </ul>

              </li>
              <li class="nav-item">
                <a href="#">
                 <i class="fa fa-angle-down"></i>
                <span class="menu-title" data-i18n="">Le cursus</span>
</a>                <ul class="menu-content">
                  <li>
                    <a href="/dashboard/cursus_submissions_guidelines?locale=fr">Contribuer au cursus ?</a>
                  </li>
                  <li>
                    <a href="/dashboard/lessons?locale=fr">Ressources</a>
                  </li>
                  <li>
                    <a href="/dashboard/projects?locale=fr">Projets</a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#">
                  <i class="fa ft-clipboard"></i>
                <span class="menu-title" data-i18n="">Corrections</span>
</a>                <ul class="menu-content">
                  <li>
                    <a href="/dashboard/corrections?locale=fr">Mes corrections</a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#">
                  <i class="fa ft-play"></i>
                <span class="menu-title" data-i18n="">Projets Finaux</span>
</a>                <ul class="menu-content">
                  <li>
                    <a href="/dashboard/final_projects?locale=fr">Les Projets Finaux</a>
                  </li>
                </ul>
                <ul class="menu-content">
                  <li>
                    <a href="/dashboard/final_projects/new?locale=fr">Proposer un projet final</a>
                  </li>
                </ul>
              </li>
              <li class="nav-item">
                <a href="#">
                  <i class="fa  fa-cogs"></i>
                  <span class="menu-title">Liens Pratiques</span>
</a>                <ul class="menu-content">
                  <li>
                    <a href="/fr/modalites">Modalit√©s</a>
                  </li>
                  <li>
                    <a href="https://blog.thehackingproject.org/2019/01/03/le-guide-de-survie-du-moussaillon/" target="_blank">Le guide de survie</a>
                  </li>

                </ul>
              </li>
              <!--
              <li class=" nav-item">
                <a href="#">
                   <i class="ft-box"></i>Ressources
</a>                <ul class="menu-content">
                  <li><a class="menu-item" href="#">Ruby</a>
                    <ul class="menu-content">
                        <li><a class="menu-item" href="#">Ressource 1</a>
                        </li>
                        <li><a class="menu-item" href="#">Ressource 2</a>
                        </li>
                      </ul>
                  </li>
                  <li><a class="menu-item" href="#">Rails</a>
                  </li>
                  <li><a class="menu-item" href="#">Html &amp Css</a>
                  </li>
                  <li><a class="menu-item" href="#">Javascript</a>
                  </li>
                  <li><a class="menu-item" href="#">Github</a>
                  </li>

                </ul>
              </li> -->
            <!-- <li class=" nav-item">
              <a href="#">
                 <i class="ft-zap"></i>
                <span class="menu-title" data-i18n="">Dans ma ville</span>
</a>                <ul class="menu-content">
                    <li>
                      <a class="menu-item" href="#">O√π travailler ?</a>
                    </li>
                    <li>
                      <a class="menu-item" href="#">O√π d√©compresser ?</a>
                    </li>
                    <li>
                      <a class="menu-item" href="#">Les autres mouss'</a>
                    </li>
                </ul>
            </li> -->
          </ul>
        </div>
        <div class="navigation-background"></div>
    </div>


<div class="app-content content">
  <div class="content-wrapper">
    <div class="content-wrapper-before"></div>
    <div class="content-header row"></div>
    
      
<div class="content-body">
      <h2 class="text-center">Passage de SQL √† ActiveRecord</h2>
      <h4 class="text-center">Initiation √† Rails</h4>
  <div class="row">
     <div class="col-xl-3 col-lg-6 col-md-12">
  <div class="card">
    <div class="card-content">
      <div class="card-body">
        <div class="media d-flex">
          <div class="align-self-top">
              <i class="ft-calendar icon-opacity info font-large-4"></i>
          </div>
          <div class="media-body text-right align-self-bottom mt-3">
              <span class="d-block mb-1 font-medium-1"></span>
              <h3 class="info mb-0">
                 Jour 24 / 55</h3>
          </div>
        </div>
        <div class="progress progress-sm mt-1 mb-0 box-shadow-2">
            <div class="progress-bar bg-gradient-x-info" role="progressbar" style="width: 43%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="120">
            </div>
        </div>
      </div>
    </div>
  </div>
 </div>


    <div class="col-xl-3 col-lg-6 col-md-12">
  <div class="card">
    <div class="card-content">
      <div class="card-body">
        <div class="media d-flex">
          <div class="align-self-top">
            <i class="ft-heart icon-opacity danger font-large-4"></i>
          </div>
          <div class="media-body text-right align-self-bottom mt-3">
            <span class="d-block mb-1 font-medium-1">Jokers restant</span>
            <h3 class="danger mb-0">
                3
            </h3>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

    <div class="col-xl-3 col-lg-6 col-md-12">
    <div class="card">
        <div class="card-content">
            <div class="card-body">
                <div class="media d-flex">
                    <div class="align-self-top">
                        <a href="/dashboard/assignments?locale=fr">
                           <i class="ft-fast-forward icon-opacity warning font-large-4"></i>
</a>                    </div>
                    <div class="media-body text-right align-self-bottom mt-3">
                        <span class="d-block mb-1 font-medium-1">Missions</span>
                            <div class="badge border-danger danger badge-border">Pas inscrit</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

  </div>
  <div class="row">
        <div class="container">
    <div class="col-xl-12 col-lg-12 col-md-12">
    <div class="card">
        <div class="card-header">
        <h1 >Initiation √† Rails
                <i class="fa fa-space-shuttle text-danger"></i>
        </h1>
        
        </div>
        <div class="card-content">
        <div class="card-body">
            <div class="card-text">
            <h2 class="text-center">Passage de SQL √† ActiveRecord</h2>
            <div class="cd-horizontal-timeline loaded">
                <div class="timeline">
                <div class="events-wrapper">
                    <div class="events" style="width: 1800px;">
                    <ol>
                                <li>
                                    <a style="left:120px;" href="/dashboard/weeks/4/days/1?locale=fr">
                                        Lun
                                            <i class="fa fa-beer text-warning" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Rendez-vous pour boire un coup"></i>

</a>                                </li>
                                <li>
                                    <a style="left:240px;" href="/dashboard/weeks/4/days/2?locale=fr">
                                        Mar
                                            <i class="fa fa-beer text-warning" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Rendez-vous pour boire un coup"></i>

</a>                                </li>
                            <li>
                                <a class="selected" style="left:360px;" data-toggle="tooltip" data-placement="top" title="Passage de SQL √† ActiveRecord" href="/dashboard/weeks/4/days/3?locale=fr">
                                    Mer
                                        <i class="fa fa-rocket text-danger" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Projet √† rendre ce jour-l√†"></i>

</a>                                </li>
                                <li>
                                    <a style="left:480px;" href="/dashboard/weeks/4/days/4?locale=fr">
                                        Jeu
                                            <i class="fa fa-rocket text-danger" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Projet √† rendre ce jour-l√†"></i>
    <i class="fa fa-pencil text-success" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Corrections cette journ√©e l√†" ></i>

</a>                                </li>
                                <li>
                                    <a style="left:600px;" href="/dashboard/weeks/4/days/5?locale=fr">
                                        Ven
                                            <i class="fa fa-pencil text-success" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Corrections cette journ√©e l√†" ></i>


</a>                                </li>
                    </ol>
                </div>
                </div>
            </div>
            </div>
        </div>
        </div>
    </div>
    </div>
<div>
  </div>

  <!-- Les fameuses corrections qui n'arrivnet que les jours concern√©s -->


    <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Ta premi√®re application Rails</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>On a vu ensemble Sinatra¬†: un langage bas-niveau qui permet de faire du web de mani√®re simple et o√π le d√©veloppeur a la ma√Ætrise de son application. L'avantage pour nous est que son aspect minimaliste te fait mettre les mains dans le cambouis et te fait comprendre comment marchent les requ√™tes. Le d√©faut est que tu es enti√®rement ma√Ætre de l'architecture de l'application, ce qui n'est pas forc√©ment simple √† g√©rer en tant que d√©veloppeur d√©butant. Plus ton application va devenir complexe, plus tu vas devoir prendre des d√©cisions sur la fa√ßon d'organiser les diff√©rents √©l√©ments de ton code‚Ä¶ et tu n'as pas encore l'exp√©rience pour faire les bons choix qui s‚Äôav√©reront payants √† long terme¬†! Maintenant on va passer √† Rails qui impose des conventions assez fortes¬†: l'avantage, c'est qu'elles te guident dans tes choix. Et du coup √ßa se passe, comme sur des rails üöÇ.</p>

<p>Hier, on a abord√© les bases de donn√©es et c'est chouette, tr√®s chouette, de faire du SQL. Mais √† partir de maintenant, nous allons passer par une surcouche de Rails pour g√©rer nos BDD¬†: ActiveRecords.</p>

<p>Pour les trois prochains jours, nous n'allons faire que du backend, et 0 frontend avec plusieurs objectifs en t√™te¬†: </p>
<ul>
  <li>Le premier est de faire une introduction tout en douceur de Ruby on Rails (RoR), √©tant donn√© que tu ne vas faire que de l'interaction avec la base de donn√©es (on va se concentrer sur la partie Model du MVC).</li>
  <li>Le second de te donner des bases robustes en cr√©ation de base de donn√©es, une comp√©tence incontournable quand on fait des applications web. Si je te demande aujourd'hui de mod√©liser la base de donn√©es de Tinder, tu ne saurais pas comment faire (et c'est normal). Mais d'ici √† vendredi soir, tu auras les bons r√©flexes pour tout faire toi-m√™me et pouvoir l'impl√©menter sur l'application de tes r√™ves.</li>
  <li>Enfin, le troisi√®me objectif est un totem dans la cr√©ation d'appli web¬†: il faut √™tre capable de cr√©er des bases de donn√©es robustes bas√©es sur des models en b√©ton arm√©. Si la BDD de ton appli peut √™tre facilement pollu√©e par des entr√©es √† moiti√© remplies et incoh√©rentes entre elles, c'est toute ton appli qui pourra finir √† la poubelle. Donc nous allons t'apprendre √† construire des bases de donn√©es qui restent propres dans la dur√©e.</li>
</ul>

<p>Dans cette ressource, tu vas cr√©er ta premi√®re application en Ruby on Rails. Waow¬†!</p>

<h2>2. Historique</h2>
<p>Rails a √©t√© cr√©√© en 2005 par un certain David Heinemeier Hansson, plus connu sous le nom <b>DHH</b> (super compte Twitter √† suivre BTW). La gen√®se de Rails a eu lieu √† Basecamp, la fameuse start-up de DHH, o√π il a imagin√© un framework pour faire du web √† partir de Ruby. Rails a √©t√© con√ßu en privil√©giant l'agilit√© et la cr√©ation rapide, afin de pouvoir produire des applications facilement modifiables. Il a bas√© Rails sur plusieurs id√©es originales et plusieurs sont maintenant des standards de l'industrie (par exemple, le principe de migrations que l'on va d√©couvrir ensemble).</p>

<div class="card box-shadow-0 border-success">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üìö INSTANT CULTURE G√â</h4>
      <p class="card-text">DHH a fait d'autres choses dans sa vie que bouleverser le monde du web. Je consid√®re personnellement BaseCamp, l'entreprise dont il est co-fondateur et CTO, comme l'une des toutes premi√®res startup de l'√®re moderne, <i>√† la</i> Trello, Slack, et son livre <a href="https://basecamp.com/books/rework" target="_blank">REWORK</a> est une bible du management moderne d'entreprise.</p>
    </div>
  </div>
</div>

<p>Rails est bas√© sur plusieurs philosophies :</p>
<ul>
  <li><b>Convention Over Configuration</b>¬†: l√† o√π Sinatra te donne absolument tous les droits pour faire ce que tu veux pour tes applications, une application Rails est structur√©e d√®s sa cr√©ation. Elle est "livr√©e" avec son dossier controller, son fichier routes, son syst√®me de bases de donn√©es. Ces conventions sont g√©niales pour aller plus vite dans la r√©alisation d'applications, la contrepartie est qu'en sortir (le jour o√π tu seras un demi-dieu du dev) rel√®ve du parcours du combattant.</li>
  <li><b>Don't Repeat Yourself</b> (DRY) : Rails de donne la possibilit√© de facilement r√©unir ton code dans des fichiers afin de les rappeler √† plusieurs endroits de ton app. Ainsi, inutile d'√©crire 2 fois la m√™me chose¬†! C'est du coup plus facile √† lire (on ne lit qu'une fois et pas 10) et plus facile √† modifier (√† un seul endroit, pas √† 10).</li>
</ul>

<p>Au fil des ann√©es, Rails est devenu un langage de programmation tr√®s populaire dans l'univers du web, avec un apog√©e en 2011. Son principe de migration a inspir√© le reste du web actuel, et sa rapidit√© de mise en ≈ìuvre coupl√©e √† une puissance et rapidit√© d'ex√©cution en font un outil encore tr√®s populaire. Rails et Ruby sont moins en vue ces derniers temps, mais leur popularit√© reste tr√®s convenable, avec des jolis noms utilisant la techno¬†: Algolia, Airbnb, Qonto, Drivy, JobTeaser, SoundCloud, Github, The Hacking Project, pour ne citer qu'eux.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">ü§ì QUESTION R√âCURRENTE</h4>
      <p class="card-text"><b>Mais si Ruby et Rails sont en perte de vitesse, on ne perd pas notre temps √† apprendre ce framework et ce langage¬†?</b><br>
      Absolument pas. Et cela pour plusieurs raisons :</p>
      <ul>
        <li>La communaut√© Ruby et Rails est plus restreinte que celle de langages plus populaires mais elle est tr√®s active¬†: de nombreux projets open-source (dont Rails) sont mis √† jour tous les mois.</li>
        <li>C'est aussi une communaut√© de qualit√©¬†: les documentations sont g√©n√©ralement bonnes et l'aide est facile √† trouver via une recherche Google. Sans parler du fait que la <a href="https://dev.to/ben/ruby-has-the-kindest-programming-community-and-i-have-the-data-to-prove-it-4f60">communaut√© Ruby est globalement bienveillante</a>. Tous les langages ne peuvent pas en dire autant. üòè </li>
        <li>Ils se sont impos√©s dans le paysage du web et ne sont clairement pas en position de dispara√Ætre sous peu. Rails et Ruby ont encore de beaux jours devant eux¬†!</li>
        <li>Last but not Least¬†: en termes de facilit√© de mise en ≈ìuvre et de rapidit√© de prise en main, Rails n'a pas d'√©gal. Et dans un bootcamp comme THP, sur 11 semaines, un d√©butant ne pourrait pas faire tout ce qu'on va te pr√©senter avec un autre framework. Du coup, apprendre Rails c'est super gratifiant pour un d√©butant¬†: √ßa augmente nettement tes chances d'aller au bout de la formation et poursuivre dans la voie du d√©veloppement. </li>
      </ul>
      <p>Au final, Ruby + Rails est une super porte d'entr√©e dans le monde du d√©veloppement. Mais pas seulement¬†! Nombreux sont ceux qui restent sur cette stack √† l'issue de THP. <br>
      => On esp√®re que tu seras convaincu de tout cela √† l'issue des 11 semaines. Ce sera alors ton tour d'√©vang√©liser les sceptiques. ü§ó </p>
    </div>
  </div>
</div>



<h2>3. La ressource</h2>
<h3>3.1. Rails en bref</h3>

<p>Aujourd'hui, on va (enfin¬†!) faire du Rails. Mais avant √ßa, rappelons les bases : Rails est un framework web, open-source et √©crit en Ruby. Ce framework est pens√© avant tout pour les devs et suit deux principes¬†: "Convention over configuration" et "Don't repeat yourself (DRY)". Rails est assez rigide dans sa mani√®re de faire mais une fois ma√Ætris√©, tu deviens hyper efficace en le manipulant¬†! En comparaison, l√† o√π cr√©er une fonctionnalit√© en Rails n√©cessite une dizaine de lignes de code, il en faudrait cinquantaine en Sinatra.</p>

<h3>3.2. Cr√©er son app rails</h3>

<p>Pr√™t¬†? C'est le moment de gloire o√π tu vas cr√©er ta premi√®re application Rails. Ouvre donc ton terminal et d√©place-toi dans ton r√©pertoire de travail. Tape la commande :</p>

<pre><code class="language-shell">$ rails new my_first_app</code></pre>
<p>Cela va cr√©er un nouveau dossier Rails nomm√© <code>my_first_app</code>. Tu n'as plus qu'a te d√©placer dans ce r√©pertoire et lancer la fameuse commande :</p>

<pre><code class="language-shell">$ bundle install</code></pre>

<p>Tadam¬†! Tu as cr√©√© ta premi√®re app Rails¬†! Prenons deux secondes pour nous recueillir et profiter de ce moment historique. <br>
OK. <br>
Maintenant, regarde un peu ton dossier Rails¬†: tu remarqueras qu'une app rails comporte √©norm√©ment de dossiers et de sous-dossiers. C'est impressionnant au d√©but mais c'est normal. Aujourd'hui, nous allons travailler essentiellement avec le dossier <b>db</b> qui se trouve √† la racine et avec le sous-dossier <b>model</b> qui se trouve dans le dossier <b>app</b>. Si tu ouvres le contenu de ton dossier avec ton √©diteur de texte, tu devrais avoir une architecture du type¬†: </p>
<pre><code class="language-shell">.
|-- app
|   |-- assets
|   |   |-- images
|   |   |-- javascripts
|   |   |   `-- application.js
|   |   `-- stylesheets
|   |       `-- application.css
|   |-- controllers
|   |   |-- application_controller.rb
|   |   `-- concerns
|   |-- helpers
|   |   `-- application_helper.rb
|   |-- mailers
|   |-- models
|   |   `-- concerns
|   `-- views
|       `-- layouts
|           `-- application.html.erb
|-- bin
|   |-- bundle
|   |-- rails
|   |-- rake
|   |-- setup
|   `-- spring
|-- config
|   |-- application.rb
|   |-- boot.rb
|   |-- database.yml
|   |-- environment.rb
|   |-- environments
|   |   |-- development.rb
|   |   |-- production.rb
|   |   `-- test.rb
|   |-- initializers
|   |   |-- assets.rb
|   |   |-- backtrace_silencers.rb
|   |   |-- cookies_serializer.rb
|   |   |-- filter_parameter_logging.rb
|   |   |-- inflections.rb
|   |   |-- mime_types.rb
|   |   |-- session_store.rb
|   |   `-- wrap_parameters.rb
|   |-- locales
|   |   `-- en.yml
|   |-- routes.rb
|   `-- secrets.yml
|-- config.ru
|-- db
|   `-- seeds.rb
|-- Gemfile
|-- Gemfile.lock
|-- lib
|   |-- assets
|   `-- tasks
|-- log
|-- public
|   |-- 404.html
|   |-- 422.html
|   |-- 500.html
|   |-- favicon.ico
|   `-- robots.txt
|-- Rakefile
|-- README.rdoc
|-- test
|   |-- controllers
|   |-- fixtures
|   |-- helpers
|   |-- integration
|   |-- mailers
|   |-- models
|   `-- test_helper.rb
|-- tmp
|   `-- cache
|       `-- assets
`-- vendor
`-- assets
    |-- javascripts
    `-- stylesheets</code></pre>

<p>Si tu regardes bien, il y a certains fichiers que tu as d√©j√† vus :
<ul>
  <li><b>Gemfile</b>¬†: ‚ö†Ô∏è Attention √† bien avoir les versions THP de Ruby et Rails sinon tu risques de perdre des points b√™tement lors des prochains projets ‚ö†Ô∏è</li>
  <li><b>App/views</b>¬†: Dans ce dossier, tu pourras concevoir l'ensemble de la partie visuelle de ton app.</li>
  <li><b>App/controllers</b>¬†: Ce dossier contiendra tes controllers qui font le lien entre tes vues et tes mod√®les.</li>
  <li><b>App/model</b>¬†: C'est ici que se trouve toute la logique qui lie les objets Ruby (utilisables ensuite dans les controllers et views) avec des tables SQL (la BDD).</li>
  <li><b>Config/routes.rb</b>¬†: c'est ici o√π tu peux cr√©er tes routes (statiques comme dynamiques).</li>
  <li><b>/db</b>¬†: C'est l√† que se trouve la base de donn√©es de l'app.</li>
</ul>

<p>Pour en savoir un peu plus, tu peux regarder <a href="https://youtu.be/2MdBvjYtE18?list=PLjwdMgw5TTLWfI1B2Wv2WPgR9iOyw12zi&t=236" target="_blank">cette vid√©o</a> de Grafikart √† partir de la minute 4, jusqu'√† la minute 9. Pas de panique si tu ne comprends pas tout, ces notions seront d√©velopp√©es plus tard üòè</p>



<h2>4. Points importants √† retenir</h2>
<p>Rails est un framework de Ruby qui permet de faire du web, cr√©√© en 2005 par David Heinemeier Hansson. Sa force r√©side dans sa rapidit√© de mise en place, et (entre autres) dans sa fa√ßon tr√®s souple de g√©rer des bases de donn√©es.</p>

<p>Pour cr√©er une application Rails, il suffit de faire <code>$ rails new nom_de_mon_app</code>. <br>
Cette commande cr√©e automatiquement tout une architecture logicielle √† laquelle il faut se conformer.</p>


<h2>5. Pour aller plus loin</h2>
<p>Rails a l'une des meilleures docs qui existe, avec les Rails Guides. Un peu obscurs au d√©but, ces guides te seront d'une aide plus que pr√©cieuse quand tu auras un niveau interm√©diaire. Tu peux la parcourir mais c'est probablement un peu t√¥t pour aller checker <a href="https://guides.rubyonrails.org/">la documentation officielle</a>.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Rails Model: les BDD en Rails (migrations, cr√©ation, etc.)</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>Maintenant que tu as vu SQL, un puissant langage qui permet d'interagir avec des bases de donn√©es, on va t'expliquer comment Ruby on Rails g√®re les BDD. Tout s'articule autour d'une gem nomm√©e <a href="https://github.com/rails/rails/tree/master/activerecord" target="_blank">ActiveRecord</a> qui permet de transformer une table de BDD (les fameux tableaux Excel dans lesquels on stocke les donn√©es) en classe Ruby (et donc en objet et instances). L'alliance des deux va transformer les requ√™tes SQL un peu barbares comme <code>SELECT * from User</code> en un plus simple <code>User.all</code> en Ruby.</p>

<p>Cette ressource sera cons√©quente et va faire le lien entre 2 choses que tu viens √† peine de d√©couvrir¬†: la POO et les BDD. Prends bien le temps de la comprendre¬†! Quitte √† la relire plusieurs fois (et ce week-end) si besoin. <br>
On va t'expliquer 4 concepts cl√©s dans la mod√©lisation de bases de donn√©es en Rails :</p>

<ol>
  <li>Qu'est-ce qu'ActiveRecord¬†;</li>
  <li>Les migrations¬†;</li>
  <li>Le model dans Rails¬†;</li>
  <li>Comment lier tables et models entre eux dans Rails.</li>
</ol>

<h2>2. Historique</h2>
<p>L'une des id√©es novatrices que Rails a apport√© dans le monde du web, c'est la fa√ßon dont ses applications g√®rent leurs bases de donn√©es. D√©j√†, utiliser ActiveRecord lui permet de transformer ses tables de BDD en objets Ruby. On retire une information de la BDD (par exemple le pr√©nom d'un utilisateur) sous la forme d'un simple <code>mon_user.first_name</code>.</p>

<p>Ensuite, le principe de migration a permis d'avoir des bases de donn√©es facilement modifiables alors m√™me que l'application tourne d√©j√†. C'est crucial pour toute jeune entreprise qui avance √† tatons (aka les startups). On verra plus en d√©tails ce qu'est une migration mais, en gros, l'id√©e est d'avoir un dossier qui contient tout l'historique de tous les changements faits sur ta base de donn√©es. Le principe de migration est devenu rapidement tr√®s populaire et une bonne partie des frameworks web modernes l'utilisent d√©sormais.</p>



<h2>3. La ressource</h2>
<h3>3.1. ActiveRecord dans Rails</h3>
<p>Tu as vu r√©cemment le mod√®le MVC en Ruby, qui te permet de d√©composer un programme¬†: la partie M est le Model, soit celle qui interagit avec ta base de donn√©es. Pour le moment, tes mod√®les ne jouaient qu'avec des fichiers CSV, et tu as vu hier que SQL √©tait THE langage de pr√©dilection pour interagir avec une BDD. Eh bien gr√¢ce √† ActiveRecord, nous pouvons faire tout ceci d'un coup¬†!</p>

<p>ActiveRecord est une gem impl√©ment√©e dans Rails qui d√©compose toutes tes tables en classes Ruby. Dit autrement, dans ton application, tu ne seras pas oblig√© de travailler avec du SQL : tu pourras d√©finir tes models de base de donn√©es comme tu d√©finis une classe Ruby. Et c'est ultra pratique.</p>


<h3>3.2. Les migrations</h3>
<h4>3.2.1. Qu'est-ce qu'une migration¬†?</h4>
<h5>3.2.1.1. Avant les migrations</h5>
<p>Quand tu cr√©es une application Rails, ton fichier <code>base_de_donn√©es.sql</code> est vide. 0 table, 0 colonne. Il faut donc lui ajouter des tables et des colonnes. Avant le syst√®me de migrations, on se tapait des grosses commandes SQL du type :</p>

<pre><code class="language-sql">CREATE TABLE CUSTOMER
(
  CustomerID INT NOT NULL,
  CustomerName VARCHAR(40) NOT NULL,
  CustomerZip VARCHAR(10) NOT NULL,
  PRIMARY KEY (CustomerID)
);

CREATE TABLE SALESTRANSACTION
(
  TID INT NOT NULL,
  Tdate DATE NOT NULL,
  CustomerID INTEGER NOT NULL,
  FOREIGN KEY (CustomerID) REFERENCES CUSTOMER(CustomerID)
);</code></pre>

<p><b>Les migrations permettent d'√©viter ce genre de barbarie SQL</b>¬†: on √©crit la demande de cr√©ation de table dans un langage plus simple √† comprendre et directement lu par Rails (inutile de jongler entre 2 interfaces, Rails et SQL).</p>

<p> Imagine maintenant le cas suivant¬†: tu as cr√©√© une application web avec ton √©quipe de 5 d√©veloppeurs et le site tourne plut√¥t bien. Vous avez d√©j√† acquis un millier de clients et tu te rends compte que tu as fais du üí© en cr√©ant la table des utilisateurs il y a 2 mois. Elle dispose d'une colonne <code>zip_code</code> (le code postal de l'utilisateur) que tu as mis au format <code>integer</code>. Tout allait bien jusqu'√† ce que tu te rendes compte que ce n'√©tait pas une bonne id√©e (quid des pays ayant des codes postaux avec des lettres¬†?? Ou alors le code postal de Nice qui passe de <code>06000</code> √† <code>6000</code>¬†??). Tu aimerais donc bien passer tous tes codes postaux en <code>string</code>, un format bien plus appropri√©. Bien entendu (et c'est l√† un point crucial de ton business naissant), ta base de donn√©es est d√©j√† pleine¬†: tu veux conserver tous les codes postaux des utilisateurs d√©j√† en base¬†!!</p>

<p>Dans une BDD, avant les migrations, tu te serais tap√© un max d'op√©rations en SQL pour mettre la BDD de ton ordinateur (qui te permet de tester l'app Rails) √† jour. Il aurait fallu 1) cr√©er une 2√®me table avec une colonne <code>zip_code</code> de type <code>string</code>, 2) copier coller chaque entr√©e de la table originelle vers la nouvelle, 3) supprimer l'ancienne table et 4) renommer la nouvelle table pour qu'elle prenne d√©finitivement la place de l'ancienne. <b>Les migrations automatisent (en 1 ligne) ces op√©rations de changement tout en conservant les donn√©es existantes</b>. </p>

<p>Une fois ces op√©rations SQL valid√©es, il aurait fallu les appliquer √† la BDD de ton app en PROD (celle qui tourne sur le serveur web et que les clients utilisent) afin de corriger ta bourde. Et finalement, tu aurais d√ª aussi appliquer ces modifications sur les ordinateurs de tous les devs de l'√©quipe pour que leur BDD √† eux soit √©galement √† niveau. Bien s√ªr, interdiction de se rater et d'oublier une ligne SQL sur aucun ordinateur : on peut parler <a href="https://www.youtube.com/watch?v=k_yLPiPMmrw">de merdier</a> √† ce niveau-l√†.</p>

<p>On peut m√™me aller plus loin¬†: finalement tu regrettes ta modification de BDD, car elle introduit un bug, fait p√©ter toute ton application et le service est down¬†! Il ne te reste plus qu'√† passer les commandes SQL inverses en urgence et dans le bon ordre s'il te pla√Æt. Ta carri√®re de d√©veloppeur va int√©resser les arch√©ologues¬†: elle est en ruines.</p>

<b><p>Je pense que tu as pig√© la puissance des migrations. En r√©sum√©, elles permettent :</p>
<ul>
  <li>De g√©rer les modifications de la BDD directement dans Rails (et non via une interface SQL)¬†;</li>
  <li>De faire des modifications de BDD sur une ligne de commande, sans perte des donn√©es existant d√©j√† en BDD¬†; </li>
  <li>De facilement transf√©rer d'une personne √† l'autre les modifications √† apporter √† la BDD pour qu'elle soit dans l'√©tat final souhait√© (chaque ordi a sa propre BDD + celles des serveurs) ;</li>
  <li>De revenir rapidement (une commande¬†!) en arri√®re en jouant une migration √† l'envers.</li>
</ul></b>

<h5>3.2.1.2. Le dossier des migrations</h5>
<p>Les migrations sont consign√©es dans un dossier qui contient alors tout l'historique de toutes les modifications que l'on a apport√©es √† sa base de donn√©es. Un peu comme √ßa :</p>

<pre><code class="language-shell">Jour 1 - cr√©ation d'une table utilisateurs avec une colonne pr√©nom et une colonne email
Jour 6 - cr√©ation d'une table ville et ajout d'une relation entre les villes et les utilisateurs
Jour 15 - suppression de la colonne email chez les utilisateurs
Jour 17 - ajout d'une colonne nom de famille dans la table des utilisateurs
Jour 28 - cr√©ation d'une table couscous pour lister les meilleurs adresses de la ville</code></pre>

<p>Une migration peut avoir 2 statuts¬†: <code>up</code> ou <code>down</code>.</p>

<ul>
  <li><code>up</code>¬†: elle a √©t√© pass√©e et est appliqu√©e √† ta base de donn√©e actuelle.</li>
  <li><code>down</code>¬†: elle n'est pas encore pass√©e (ou a √©t√© annul√©e).</li>
</ul>

<p>Pour chaque migration, il y a une action pour passer de <code>down</code> √† <code>up</code> (cela s'appelle "passer une migration"), et une action pour passer de <code>up</code> √† <code>down</code> (cela s'appelle "faire un rollback"). Par exemple :</p>

<ul>
  <li>Pour une migration qui cr√©e une table pour les utilisateurs¬†:
  <ul>
    <li>L'action de <code>down</code> √† <code>up</code> sera de cr√©er une table utilisateurs</li>
    <li>L'action de <code>up</code> √† <code>down</code> sera de d√©truire la table utilisateurs (attention, la perte de donn√©e est irr√©versible dans ce cas)</li>
  </ul></li>
  <li>Pour une migration qui ajoute une colonne <code>email</code> √† la table utilisateurs :
  <ul>
    <li>L'action de <code>down</code> √† <code>up</code> sera de cr√©er une colonne <code>email</code> dans la table utilisateurs</li>
    <li>L'action de <code>up</code> √† <code>down</code> sera de d√©truire la colonne <code>email</code> de la table utilisateurs (attention, la perte de donn√©e est irr√©versible dans ce cas)</li>
  </ul></li>
  <li>Pour une migration qui cr√©e une table pour les utilisateurs et qui lui donne une colonne <code>first_name</code>
  <ul>
    <li>L'action de <code>down</code> √† <code>up</code> sera de cr√©er une table utilisateurs et lui cr√©er une colonne <code>first_name</code></li>
    <li>L'action de <code>up</code> √† <code>down</code> sera de d√©truire la colonne <code>first_name</code> de la table utilisateurs et de d√©truire la table (attention, la perte de donn√©e est irr√©versible dans ce cas)</li>
  </ul></li>
  <li>Bref, tu vois la logique</li>
</ul>

<div class="card box-shadow-0 border-success">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üìö INSTANT CULTURE G√â</h4>
      <p class="card-text">Pour tester si une migration est bien faite, un d√©veloppeur senior va faire une s√©rie d'acions :</p>
      <ul>
        <li>Passer de <code>down</code> √† <code>up</code> pour voir si elle marche bien</li>
        <li>Passer de <code>up</code> √† <code>down</code> pour voir s'il est possible de revenir en arri√®re</li>
        <li>Repasser de <code>down</code> √† <code>up</code> pour la prendre en compte</li>
      </ul>
      <p>Savoir ceci peut te valoir des points en entretien d'embauche¬†;)</p>
    </div>
  </div>
</div>

<h4>3.2.2. Cr√©er et effectuer ses premi√®res migrations</h4>
<h5>a) Cr√©er sa premi√®re migration</h5>
<p>Toutes les migrations de ton application se trouvent dans le dossier <code>db/migrate/</code> au format <code>AAAAMMDDHHMMSS_nom_migration.rb</code> (AAAAMMDDHHMMSS = date et heure pr√©cise de cr√©ation de la migration). Pour le moment tu n‚Äôen as pas, donc nous allons cr√©er ta premi√®re migration. Avec Rails c'est facile, il suffit de rentrer la ligne de commande suivante :</p>

<pre><code class="language-shell">$ rails generate migration NomDeTaMigration</code></pre>

<p>Si tu ex√©cutes cette commande, il devrait cr√©er un fichier de migration qui ressemble √† quelque chose comme √ßa :</p>


<pre><code class="language-ruby">class NomDeTaMigration < ActiveRecord::Migration[5.2]
  def change
    # ici tu mettras les modifications que tu aimerais apporter √† ta base de donn√©es
  end
end</code></pre>

<p>Pour effectuer la migration (ne le fais pas pour le moment, car ta m√©thode <code>change</code> est vide), il te suffira de saisir la commande :</p>

<pre><code class="language-shell">$ rails db:migrate</code></pre>

<h5>b) Des exemples de migration</h5>
<p>Voici quelques exemples de migration. Pour le moment contente-toi de lire, tu pourras revenir ici ensuite quand nous passerons √† la pratique.</p>

<p>Voici une migration qui dit "cr√©e une table <code>users</code>" :</p>
<pre><code class="language-ruby">def change
  create_table :users do |t|
    t.timestamps
  end
end</code></pre>
<p>Les lignes <code>create_table :users do --- end</code> donnent l'ordre de cr√©er une table <code>users</code> dont les colonnes vont √™tre d√©finies entre <code>do</code> et <code>end</code>. <br>
Pour le moment on ne d√©finit que 2 colonnes en 1 ligne avec <code>t.timestamps</code>¬†: il s'agit de 2 colonnes qui porteront les intitul√©s <code>created_at</code> et <code>updated_at</code>. Elles permettront de suivre automatiquement (pour chaque entr√©e de la table) la date et l'heure de cr√©ation et de derni√®re mise √† jour. C'est une bonne pratique donc Rails proposera automatiquement ces colonnes √† la cr√©ation d'une table. <br>
Note aussi que si cette migration est ex√©cut√©e, la table <code>users</code> contiendra une 3√®me colonne intitul√©e <code>id</code>. C'est la fameuse primary key dont on a parl√© en SQL (pour identifier de fa√ßon unique chaque entr√©e). Cette colonne est indispensable pour g√©rer ta table: elle sera toujours pr√©sente donc pas besoin de la mentionner dans la migration.</p>


<p>Voici une migration qui dit "cr√©e une table <code>users</code> et donne-lui une colonne <code>name</code>, de type string, et une colonne <code>is_admin</code>, de type bool√©en" :</p>
<pre><code class="language-ruby">def change
  create_table :users do |t|
    t.string :name
    t.boolean :is_admin
    t.timestamps
  end
end</code></pre>

<p>Si cette migration est ex√©cut√©e, une table <code>users</code> sera cr√©√©e. Cette table aura 5 colonnes : <code>id</code>, <code>name</code>, <code>is_admin</code><code>created_at</code> et <code>updated_at</code> (les deux timestamps).</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Quand tu g√©n√®res une migration √† partir de la ligne de commande, Rails peut comprendre, √† partir du nom que tu donnes √† la migration, ce que tu veux faire exactement. <br>
      Par exemple si tu veux cr√©er une table <code>users</code>, tu fais <code>$ rails generate migration CreateUsers</code> et hop, la migration comprendra d√©j√† la ligne <code>create_table :users</code> üòé</p>
    </div>
  </div>
</div>

<p>Voici une migration qui dit "dans la table <code>users</code> qui existe d√©j√†, ajoute une colonne <code>email</code>, qui sera un string" :</p>

<pre><code class="language-ruby">def change
  add_column :users, :email, :string
end</code></pre>

<p>Voici une migration qui dit "dans la table <code>users</code> qui existe d√©j√†, enl√®ve la colonne <code>is_admin</code>" :</p>

<pre><code class="language-ruby">def change
  remove_column :users, :is_admin, :boolean
end</code></pre>

<p>Bien d'autres exemples sont <a href="http://edgeguides.rubyonrails.org/active_record_migrations.html#creating-a-migration" target="_blank">disponibles dans la doc</a> (renommer une table, etc.) et Jonathan de Grafikart a fait <a href="https://youtu.be/LBtCqTeJvfg" target="_blank">une vid√©o de 10mn</a> qui explique les migrations.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Voici quelques commandes tr√®s pratiques pour √™tre le champion des migrations :</p>
      <ul>
        <li><code>$ rails db:migrate</code>¬†: Cette commande ex√©cute TOUTES les migrations du dossier <code>db/migrate</code> qui sont en statut <code>down</code>. Si tu te rends dans le dossier db apr√®s l'avoir ex√©cut√©e, et ouvre le fichier development.sqlite3, tu verras que la base a √©t√© cr√©e (et beaucoup plus facilement qu'hier en SQL).</li>
        <li><code>$ rails db:migrate:status</code>¬†: te sort un joli tableau pour voir o√π tu en es dans tes migrations entre les <code>up</code> et les <code>down</code>.</li>
        <li><code>$ rails db:rollback</code>¬†: revient en arri√®re sur la derni√®re migration. Tr√®s pratique quand on a fait une coquille qu'on d√©tecte de suite.</li>
        <li><code>$ rails db:migrate VERSION=20180905201547</code> : annule toutes les migrations post√©rieures √† celle portant le nom "20180905201547".</li></li>
      </ul>
    </div>
  </div>
</div>


<h4>3.2.3. √Ä toi de jouer¬†! Cas pratique</h4>
<p>Tr√®ves de blabla, √† toi de jouer. Cr√©e une table <code>users</code> avec les attributs suivants :</p>

<ul>
  <li>Un <code>email</code> qui est un <code>string</code></li>
  <li>Un <code>first_name</code> qui est un <code>string</code></li>
  <li>Un <code>last_name</code> qui est un <code>string</code></li>
  <li>Un <code>is_admin</code> qui est un <code>bool√©en</code></li>
  <li>Les <code>timestamps</code></li>
</ul>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">‚ö†Ô∏è ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">Attention √† ne <b>JAMAIS changer ni supprimer</b> un fichier de migration √† partir du moment o√π elle a √©t√© pass√©e. Sans le fichier de migration, Rails ne saura pas quoi faire avec ta base de donn√©es donc il sera perdu.</p>
      <p>En faisant √ßa, tu vas cr√©er des bugs relous √† g√©rer voire foutre en l'air ta base de donn√©es (et tu seras bon pour l'effacer et recommencer).</p>
    </div>
  </div>
</div>

<h3>3.3. Le model</h3>
<h4>3.3.1. Cr√©er ton model</h4>
<p>Une fois que l'on a fait ses migrations pour sa base de donn√©es, nous allons cr√©er le model correspondant √† la table. <br>
Ce qui est primordial que tu comprennes c'est que <b>pour chaque table de la BDD, il doit y avoir un model correspondant</b>. Les deux deviennent alors intimement li√©s gr√¢ce au travail invisible d‚ÄôActive Records. Si on prend l'exemple d'une table <code>users</code> li√©e au model <code>User</code>, voici comment les deux sont li√©s¬†: </p>
<ul>
  <li><b>Chaque entr√©e de la table <code>users</code> est en fait une instance de la classe <code>User</code></b>.</li>
  <li><b>On peut cr√©er une nouvelle entr√©e en BDD en faisant les lignes de Ruby </b>: <code>julie = User.new("julie", "julie@gmail.com")</code> puis <code>julie.save</code>. La table <code>users</code> est alors compl√©t√©e en BDD d'une nouvelle entr√©e avec les bonnes colonnes.</li>
  <li><b>Chaque colonne de la table est automatiquement une variable d'instance qui est d√©j√† en <code>attr_accessor</code></b>. Par exemple si je fais en Ruby <code>julie.email</code>, je r√©cup√®re bien le contenu de la colonne <code>email</code> de cet objet (par ex : "julie@gmail.com"). Et si je fais en Ruby <code>julie.email = nil</code>, puis <code>julie.save</code>, la colonne est bien modifi√©e en BDD. </li>
  <li>Et plein d'autres exemples que nous verrons.</li>
</ul>

<p> Mais quel est le r√¥le du fichier model¬†? Il sera dans le dossier <code>app/model</code> et aura pour objectif de d√©finir plusieurs choses¬†: </p>
<ul>
  <li>Les m√©thodes de classe qu'on veut pouvoir utiliser sur les instances¬†;</li>
  <li>Les validations qui sont les conditions √† remplir pour qu'une entr√©e soit consid√©r√©e comme OK et sauvegard√©e (ex¬†: impossible de cr√©er un utilisateur si le champ e-mail est vide)¬†;</li>
  <li>Les liens entre les diff√©rentes tables / models (1-N, N-N, etc.)</li>
</ul> 

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">‚ö†Ô∏è ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">On te l'a dit, en Rails c'est "Convention over configuration". Comme tout model doit avoir une table et vice et versa, leurs noms doivent respecter la convention pour que Rails sache qui va avec qui. Voici les r√®gles¬†:
      <ul>
        <li>Le nom d'une table (d√©finie dans une migration) sera <b>toujours</b> en pluriel snake_case. On parlera par exemple de la table <code>users</code>.</li>
        <li>Le nom de la classe de ton model sera <b>toujours</b> au singulier en CamelCase. On parlera par exemple du model <code>User</code>.</li>
        <li>Le nom de fichier de ton model sera <b>toujours</b> au singulier en snake_case. On parlera par exemple du fichier <code>user.rb</code></li>
      </ul>
      <p>Dans le doute, n'h√©site pas √† googler, je le fais tr√®s r√©guli√®rement¬†!</p>
    </div>
  </div>
</div>


<p>Pour cr√©er un model, Rails a une commande sp√©ciale. Comme tout model est forc√©ment li√© √† une table, cette commande aura pour effet de cr√©er une migration de cr√©ation de table en plus du model correspondant. Un petit 2-en-1 digne des meilleurs d√©tergents. <br>
Voici la commande :</p>
<pre><code class="language-shell">$ rails generate model NomDeTonModel</code></pre>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">‚ö†Ô∏è ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">Quand on d√©bute, on a tendance √† ajouter des migrations √† la va-vite sans comprendre leur implication. Si jamais tu as d√©j√† cr√©√© la table en amont du model, tu dois supprimer la migration que Rails g√©n√®re automatiquement mais bien s√ªr AVANT qu'elle n'ait √©t√© pass√©e¬†! Sinon, au prochain <code>$ rails db:migrate</code>, Rails va te gueuler dessus que tu ne peux pas cr√©er une table d√©j√† existante. Ne t'en fais pas, et dis-toi que c'est pour ton bien.</p>
      <p>√Ä partir de maintenant, essaye de cr√©er la table et le model en m√™me temps via la commande de g√©n√©ration de model. </p>
    </div>
  </div>
</div>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">La commande de g√©n√©ration d'un mod√®le te permet m√™me d'ajouter direct les colonnes de ta table DANS la migration. Par exemple si tu veux cr√©er un model user avec un email qui est un string et un is_admin qui est un bool√©en, tu √©crirais la commande :</p>
      <pre><code class="language-shell">$ rails generate model User email:string is_admin:boolean</code></pre>
      <p>Et hop, la migration est d√©j√† toute pr√™te. Il n'y a plus qu'√† la passer pour avoir la table et ses colonnes.</p>
    </div>
  </div>
</div>

<h4>3.3.2. Tester et jouer avec ton model en base</h4>
<p>Rails dispose d'une console dans laquelle tu vas pouvoir tester la cr√©ation d'instances via tes models. Elle se lance avec <code>$ rails console</code>. <br>
Lorsque ton model existera tu pourras cr√©er un utilisateur avec <code>u = User.new</code>, changer son nom avec <code>u.first_name = "F√©lix"</code>, l'afficher avec <code>u</code> puis le sauver en base avec <code>u.save</code>. <br>
Pour le moment, ne fait pas de tests (on y vient juste apr√®s !) mais sache que le terminal devrait afficher quelque chose du genre¬†: </p>

<pre><code class="language-ruby">Running via Spring preloader in process 453
Loading development environment (Rails 5.2.2)

2.5.1 :003 > u = User.new
=> #&lt;User id: nil, email: nil, first_name: nil, last_name: nil, is_admin: nil, created_at: nil, updated_at: nil> 

2.5.1 :004 > u.first_name = "F√©lix"
 => "F√©lix" 

2.5.1 :005 > u
=> #&lt;User id: nil, email: nil, first_name: "F√©lix", last_name: nil, is_admin: nil, created_at: nil, updated_at: nil>

2.5.1 :006 > u.save
   u = User.create
   (0.2ms)  begin transaction
  User Create (2.7ms)  INSERT INTO "users" DEFAULT VALUES
   (8.5ms)  commit transaction
=> #&lt;User id: nil, email: nil, first_name: "F√©lix", last_name: nil, is_admin: nil, created_at: nil, updated_at: nil>
</code></pre>

<p>Nous verrons dans la le√ßon suivante comment jouer avec la console de Rails, un super lieu chaleureux üî•</p>

<h4>3.3.3. √Ä toi de jouer¬†! Cas pratique</h4>
<p>Prends la table <code>users</code> de tout √† l'heure et cr√©e-lui le model correspondant. Il faut que tu sois capable de faire <code>User.create</code> (√©quivalent d'un <code>u = User.new</code> suivi d'un <code>u.save</code>) dans la console pour tester que le model et la table sont bien fonctionnels.</p>


<h3>3.4. Lier deux tables entre elles</h3>
<p>LE moment qui fait peur √† tout le monde¬†: comment faire en sorte que mon utilisateur puisse √™tre li√© √† des articles de blog (qu'il a √©crit)¬†? Et comment faire en sorte que chaque article ait un auteur¬†? Eh bien avec le mode d'emploi et un peu de rigueur, c'est pas si compliqu√© que √ßa.</p>

<p><b>Pour le moment, nous allons faire une relation 1-N, car ce sont les plus simples</b>. Pour que ton association marche, il faut ajouter une colonne d'index (<code>id</code>) dans une des deux tables, puis mentionner dans chaque mod√®le l'existence de cette association. C'est tout, et nous allons voir ensemble comment faire ceci - √† nouveau, pour le moment, lis sans tester. Nous pratiquerons juste apr√®s et tu pourras revenir aux explications.</p>


<h4>3.4.1. Lier les tables d√®s leur cr√©ation</h4>

<p>Prenons le cas d'un <code>Book</code>, qui aurait un <code>Author</code>. Dans ce cas, un livre n'a qu'un seul auteur, mais un auteur peut avoir √©crit plusieurs livres. Nous allons commencer par cr√©er le model <code>Author</code>, ainsi que la migration correspondante qui va cr√©er la table <code>authors</code>: </p>

<pre><code class="language-shell">$ rails generate model Author</code></pre>

<p>Ce qui aura pour effet de cr√©er le fichier <code>app/model/author.rb</code> et la migration suivante : </p>

<pre><code class="language-ruby">class CreateAuthors < ActiveRecord::Migration[5.2]
  def change
    create_table :authors do |t|
      t.timestamps
    end
  end
end</code></pre>

<p>Parfait. Maintenant nous allons faire de m√™me avec le model <code>Book</code> : </p>

<pre><code class="language-ruby">$ rails generate model Book</code></pre>

<p>Cependant, tu vas devoir modifier la migration pour que la table <code>books</code> ait une information en plus¬†: la r√©f√©rence de l'auteur de chaque livre. Pour faire √ßa, rajoute la ligne <code>t.belongs_to :author, index: true</code> dans la migration :</p>

<pre><code class="language-ruby">class CreateBooks < ActiveRecord::Migration[5.1]
  def change
    create_table :books do |t|
      t.belongs_to :author, index: true
      t.timestamps
    end
  end
end</code></pre>

<p>Cette ligne dit √† ta BDD "cr√©e une colonne qui va servir √† stocker un integer, celui-ci sera la r√©f√©rence (l'<code>id</code>) de l'auteur qui est li√© au livre". Maintenant, tu n'as plus qu'√† passer tes 2 migrations¬†: <code>$ rails db:migrate</code></p>

<p>Maintenant que l'on a bien les tables cr√©√©es, il n'y a plus qu'√† dire √† ActiveRecord de faire le lien entre les models. Il faut dire dans notre model de book qu'il appartient √† un author :</p>
<pre><code class="language-ruby">class Book < ApplicationRecord
  belongs_to :author
end</code></pre>

<p>Puis dire √† notre model d‚Äôauthor qu'il a plusieurs books :</p>
<pre><code class="language-ruby">class Author < ApplicationRecord
  has_many :books
end</code></pre>


<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">ü§ì QUESTION R√âCURRENTE</h4>
      <p class="card-text">
        <b>Mais dis donc Jamy, j'ai d√©j√† vu un truc du genre </b><code>t.references :author, foreign_key: true</code><b>, quelle est la diff√©rence avec </b><code>t.belongs_to :author, index: true</code></b>¬†?<br>
        Absolument aucune, elles veulent dire exactement la m√™me chose.
      </p>
      <p class="card-text">
        <b>Mais dis donc Jamy, dans une relation 1-N, comment savoir dans quelle table je mets l'index de l'autre¬†?</b><br>
        Il suffit de r√©fl√©chir 2 secondes et te dire "ok, l'index est <b>toujours</b> stock√© au format integer. Si je mets dans la table <code>authors</code> les index de chaque bouquin qu'il a √©crit, je vais en avoir parfois 1, parfois 5 ou parfois 1000. C'est pas g√©rable. Par contre, si je mets dans la table <code>books</code> l'index de l'auteur correspondant, comme il est unique, il n'y en aura toujours qu'un seul¬†!" Du coup tu as ta r√©ponse : c'est la table <code>books</code> qui porte l'index.
      </p>
      <p class="card-text">
        <b>Mais dis donc Jamy, comment on fait alors pour faire des relations N-N </i>ü§î</b><br>
        On devra forc√©ment rajouter une table entre les deux. Mais on verra √ßa demain ü§ì
      </p>
    </div>
  </div>
</div>

<h4>3.4.2. Ajout de liens entre 2 tables d√©j√† existantes</h4>
<p>Reprenons notre exemple avec les <code>Book</code> et les <code>Author</code> mais cette fois, imaginons que les 2 tables et les 2 models sont d√©j√† cr√©√©s <b>mais n'ont jamais encore √©t√© li√©s avec <code>t.belongs_to</code></b>. Aucune des 2 tables n'a de foreign key dans ce cas de figure. <br>
 Comment les lier √† pr√©sent¬†? Il faut commencer par ajouter l'index √† la table books, en faisant une migration :</p>

<pre><code class="language-bash">$ rails generate migration AddIndexToBooks</code></pre>

<p>Ensuite on rentre les lignes suivantes dans le fichier de migration, avant de la passer :</p>

<pre><code class="language-ruby">def change
  add_reference :books, :author, foreign_key: true
end</code></pre>

<p>Reste alors √† modifier tes mod√®les pour prendre en compte les associations :</p>
<pre><code class="language-ruby">class Book < ApplicationRecord
  belongs_to :author
end</code></pre>

<pre><code class="language-ruby">class Author < ApplicationRecord
  has_many :books
end</code></pre>

<h4>3.4.3. Fonctionnellement, √ßa rajoute quoi une relation 1-N¬†? Testons en console¬†!</h4>

<p>En ayant li√© entre eux les deux models <code>Book</code> et <code>Author</code>, Rails va te permettre tr√®s facilement de passer de l'un √† l'autre. <br>
Ainsi, si tu disposes d'une instance de <code>Book</code>, tu peux imm√©diatement r√©cup√©rer l'instance <code>Author</code> qui lui est li√©e en faisant <code>.author</code> dessus (tu noteras le singulier de "author"). <br>
Sym√©triquement, si tu disposes d'une instance de <code>Author</code> tu peux imm√©diatement r√©cup√©rer <b>un array des instances</b> <code>Book</code> qui lui sont li√©es en faisant <code>.books</code> dessus (tu noteras le pluriel de "books").</p>

<p>Pour tester en console et v√©rifier que le lien est bien fait, voici une m√©thode classique :</p>
<pre><code class="language-ruby">> b = Book.new("Les mis√©rables", 1903)
#=> cela cr√©e un book pas encore sauvegard√©

> b.author
#=> tu devrais voir "nil" car aucun objet author n'est li√© √† ce book.
#=>S'il te renvoie une erreur, c'est que le lien entre les 2 mod√®les est mal fait : il faut le revoir.

> a = Author.create("Victor Hugo", "Fran√ßais")
#=> on cr√©e une instance d'Author

> b.author = a
#=> √ßa y est, on lie l'objet "b" (book) avec l'objet "a" (author). 
#=>S'il te renvoie une erreur, c'est que le lien entre les 2 mod√®les est mal fait : il faut le revoir.

> b.save
#=> On √©crit l'objet "b" en BDD. S'il te renvoie une erreur, tu as mal suivi ce tuto

> livre = Book.last
#=> R√©cup√®re le dernier book √©crit en base (celui que tu viens de cr√©er)

>livre.author
#=> Renvoie th√©oriquement l'objet "a" (Victor Hugo)

>livre.author.books
#=> Devrait te renvoyer un array avec tous les book √©crits par Victor Hugo. Parmi eux, tu devrais trouver le book que tu viens de cr√©er</code></pre>

<p>Gr√¢ce √† ceci, tu v√©rifies que :</p>
<ul>
  <li>Tes books sont bien li√©s aux authors</li>
  <li>Tes authors sont bien li√©s aux books</li>
</ul>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Parfois tu feras <code>Truc.create</code> et la console te renverra un truc ou y'a marqu√© en rouge <code>ROLLBACK</code>. Cela veut dire que la sauvegarde n'a pas √©t√© prise en compte. Pour rem√©dier √† ceci, la m√©thode <code>#errors</code> va te sauver la vie et t'expliquer ce qui a foir√©. Exemple avec notre book :</p>
      <pre><code class="language-ruby">> b = Book.create
#=> ROLLBACK
> b.errors
#=> Author must exist</code></pre>
      <p class="card-text">√âtant donn√© que ton book <code>belongs_to</code> un auteur, eh bien <b>il faut absolument qu'un auteur soit d√©fini pour ton book AVANT de pouvoir le sauvegarder en BDD.</b> </p>
    </div>
  </div>
</div>

<h2>4. Points importants √† retenir</h2>

<p>Le syst√®me de migrations a de nombreux avantages, notamment :</p>

<ul>
  <li>Ce syst√®me permet de d√©barquer √† tout moment dans une application, savoir quelles sont les migrations qui sont faites (up) et celles qui sont √† faire (down), puis de pouvoir mettre √† jour sa base de donn√©es facilement. Tr√®s pratique pour travailler √† plusieurs dessus.</li>
  <li>Cela permet d'avoir des bases de donn√©es dynamiques que tu peux modifier facilement. Ainsi si jamais tu n'es pas content d'un model (nom foireux, mauvaise architecture), ce sera tr√®s simple de la modifier.</li>
</ul>


<p>Les principales commandes pour jouer avec les migrations sont :</p>
<ul>
  <li><code>$ rails generate migration nom_de_ta_migration</code>¬†: cr√©e une migration</li>
  <li><code>$ rails db:migrate</code>¬†: passe toutes les migrations en attente</li>
  <li><code>$ rails db:migrate:status</code>¬†: te sort un joli tableau pour voir o√π tu en es dans tes migrations entre les up et les down</li>
  <li><code>$ rails db:rollback</code>¬†: revient en arri√®re sur la derni√®re migration.</li>
</ul>

<p>Il est primordial de ne <b>JAMAIS changer ni supprimer un fichier de migration</b> √† partir du moment o√π elle a √©t√© pass√©e.</p>

<p>Chaque table (pluriel snake_case¬†: <code>users</code>) doit √™tre li√©e √† un model (singulier CamelCase¬†: <code>User</code>)</p>
<p>Tu peux cr√©er un mod√®le et la migration permettant de cr√©er sa table avec la commande <code>$ rails generate model NomDeTonModel</code> </p>


<p>Pour lier en 1-N deux tables et models entre eux, il faut proc√©der en 2 √©tapes¬†: </p>
<ol>
  <li>Ajouter la cl√© √©trang√®re dans <b>la table qui repr√©sente l'objet appartenant √† l'autre</b>. Exemple¬†: <code>book</code> appartient √† son <code>author</code>, donc c'est <code>book</code> qui aura la cl√© √©trang√®re. Soit le faire d√®s la cr√©ation de la table, soit faire une migration avec¬†: <code>add_reference :books, :author, foreign_key: true</code></li>
  <li>Lier les models en utilisant <code>has_many</code> et <code>belongs_to</code>.</li>
</ol>

<p>La commande <code>$ rails console</code> sera ta future nouvelle amie (mais on y reviendra). Elle te sera d'une <b>immense</b> utilit√© pour v√©rifier que tes models sont bien li√©s.</p>


<h2>5. Pour aller plus loin</h2>
<p>Pour te familiariser avec les migrations, tu peux aller voir <a href="https://edgeguides.rubyonrails.org/active_record_migrations.html" target="_blank">le chapitre correspondant</a>, dans la doc des Rails Guides. üçª</p>


<p>Voici un peu de lecture pour aller plus loin que les has_many et belongs_to de la ressource et mieux survivre en terres inconnues d'associations :</p>
<ul>
  <li>Voici <a href="https://www.youtube.com/watch?v=DAjfsW4gqGo" target="_blank">une vid√©o</a> qui reprend la partie sur les associations, et qui montre quelques m√©thodes en console pour jouer avec nos models.</li>
  <li>La doc contient une super grande page sur les associations entre diff√©rents mod√®les d'une app Rails, et sur les bonnes pratiques pour les r√©ussir¬†: <a href="http://guides.rubyonrails.org/association_basics.html" target="_blank">la voici</a>. On verra plus en d√©tail les associations demain mais essaye de prendre ce que tu peux dans cette doc pour le projet du jour.</li>
  <li>SitePoints ont fait <a href="https://www.sitepoint.com/brush-up-your-knowledge-of-rails-associations/" target="_blank">un bon tuto</a> qui reprend les bases des associations.</li>
</ul>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Rails Console, ta nouvelle meilleure amie</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>La console de Rails est un outil extr√™mement puissant qui te permet de lancer PRY, branch√© √† ta base donn√©es. Elle te permet de :</p>

<ul>
	<li>Naviguer dans ta base de donn√©es</li>
	<li>Tester tes models</li>
	<li>Modifier ta base de donn√©es (pratique pour cr√©er par exemple quelques utilisateurs √† la vol√©e)</li>
</ul>

<p>Dans cette ressource nous allons te montrer comment interagir avec ta base avec la console.</p>

<h2>2. Historique</h2>
<p>Heu..</p>

<h2>3. La ressource</h2>

<h3>3.1. La console</h3>
<p>La console rails est ultra importante pour tester les BDD et est surtout hyper facile d'utilisation. Il suffit de taper la ligne de commande <code>$ rails console</code> dans ton Terminal pour y avoir acc√®s. Bas√©e sur PRY, elle te permet d'ex√©cuter du Plain Old Ruby, directement via le terminal.</p>

<p>√Ä partir de l√†, tu peux tester plein de m√©thodes !</p>

<pre><code class="language-ruby">Running via Spring preloader in process 8287
Loading development environment (Rails 5.2.2)
2.5.1 :001 > puts "Hello"
Hello
 => nil 
2.5.1 :003 > u = User.create
   (0.2ms)  begin transaction
  User Create (0.6ms)  INSERT INTO "users" DEFAULT VALUES
   (6.5ms)  commit transaction
 => #<User id: 4, timestamps: nil, name: nil> 
2.5.1 :004 > u.name
 => nil 
2.5.1 :005 > u.name = "F√©lix"
 => "F√©lix" 
2.5.1 :006 > u.save
   (0.2ms)  begin transaction
  User Update (0.7ms)  UPDATE "users" SET "name" = ? WHERE "users"."id" = ?  [["name", "F√©lix"], ["id", 4]]
   (9.2ms)  commit transaction
 => true </code></pre>

<p>Nous allons voir ensemble les m√©thodes que tu peux utiliser dans la console pour t'amuser avec tes models.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Tu peux lancer la console en mode sandbox gr√¢ce √† l'option <code>$ rails console --sandbox</code>. Cela fera perdre toutes les donn√©es que tu as enregistr√©es lorsque tu quitteras la console. Pratique pour tester des models √† la vol√©e.</p>
      <p>La console tu vas t'en servir tr√®√®√®s souvent. Balance un alias pour la lancer rapidement üòâ</p>
    </div>
  </div>
</div>


<h3>3.2. Les m√©thodes importantes</h3>
<h4>3.2.1. Le CRUD</h4>
<p>Le CRUD, encore ? Et oui. Le CRUD est √† la base de toute application rails, donc autant s'y faire d√®s aujourd'hui. On y reviendra la semaine prochaine, mais sache que toute action dans le MVC de rails sera forc√©ment l'une des 4 actions du CRUD. Bref, passons √† la suite.</p>

<p>Une fois ton model cr√©√©, et li√© √† une table en base, te voici pr√™t √† t'amuser avec la console. √áa va tout d√©chirer, car les commandes pour faire un CRUD en sont bien plus faciles que du SQL classique : on ex√©cute des commandes sur notre model et les m√©thodes sont du ruby classique. Par exemple pour retrouver tous les utilisateurs c'est aussi simple que : <code>User.all</code>.</p>

<p>Voici sans plus tarder quelques fonctions de base pour interagir avec ta base de donn√©es, nous allons reprendre le CRUD vu hier :</p>

<h5>3.2.1.1. Create</h5>

<pre><code class="language-ruby">> martin = User.new(name: "Martin", email: "martion@gmail.com")
> martin.save</code></pre>

<p>ou</p>

<pre><code class="language-ruby">> martin = User.create(name: "Martin", email: "martion@gmail.com")</code></pre>

<p> <code>#create</code> est l'√©quivalent d'un <code>#new</code> suivi d'un <code>#save</code></p>

<h5>3.2.1.2. Read</h5>
<pre><code class="language-ruby">> u = User.find(3) # trouve l'utilisateur avec id = 3
> u.name #=> Affiche le pr√©nom</code></pre>

<pre><code class="language-ruby">> david = User.find_by(name: 'David')
> david #=> donnera le premier r√©sultat qui match ou retournera nil si il n'y a aucun r√©sultat</code></pre>

<p>Il est possible de faire des recherches plus complexes avec la m√©thode <code>#where</code>:

<pre><code class="language-ruby">> users = User.where(name: 'David', age: 22).order(created_at: :desc)
# Cette ligne nous donnera tout les david de 22 ans par ordre chronologique.</code></pre>

<p>‚ö†Ô∏è Pour trier par √¢ge, il faut avoir une colonne √¢ge dans son model User !</p>

<h5>3.2.1.3. Update</h5>
<pre><code class="language-ruby">> user_1 = User.find(1)
> user_1.name = "a new name"
> user_1.save</code></pre>

<p>ou</p>

<pre><code class="language-ruby">> user_1 = User.find(1)
> user_1.update(name: "a new name")</code></pre>

<p>Il est bien entendu possible d'utiliser une m√©thode <code>#where</code> pour trouver l'√©l√©ment √† modifier.

<h5>3.2.1.4. Delete</h5>
<pre><code class="language-ruby">> user_1 = User.find(1)
> user_1.destroy</code></pre>

<h5>3.2.1.5. √Ä toi de jouer !</h5>
Pour t'entra√Æner tu vas cr√©er 5 profils avec la commande <code>create</code> et 5 avec les commandes <code>new</code> et <code>save</code>. Ensuite tu vas les rechercher avec <code>find</code> et <code>find_by</code>. Tu devras modifier le nom et/ou le mail de certains profils et en supprimer d'autres qui r√©pondent √† des crit√®res que tu auras fix√©s (supprimer tous les utilisateurs qui s'appellent "Jack" par exemple. Une fois √† l'aise, tu peux attaquer la suite. Ma√Ætriser la console est <b>essentiel</b> pour pouvoir tester sa base rapidement en cr√©ant des instances et en v√©rifiant qu'elles font bien ce pour quoi elles ont √©t√© con√ßues. </p>


<h4>3.2.2. Quelques m√©thodes</h4>


<p> üéÅBONUS üéÅ: La liste des fonctions pr√©f√©r√©es du dev THP
<ul>
  <li><code>#all</code> : te ressort tout les √©l√©ments de ton mod√®le</li>
  <li><code>#new</code> : cr√©er une nouvelle instance de ton mod√®le</li>
  <li><code>#save</code> : enregistre cette instance</li>
  <li><code>#create</code> : cr√©er et enregistre une instance de mod√®le</li>
  <li><code>#update(attribute: value)</code> : met √† jour ton model</li>
  <li><code>#last</code> : pour v√©rifier la derni√®re entr√©e en base</li>
  <li><code>#first</code> : pareil mais pour la premiere</li>
  <li><code>#find_by(attribute: value)</code> : pour rechercher une valeur sp√©cifique</li>
  <li><code>#where(attribute: value)</code> : te ressort tous les √©l√©ments qui ont <code>value</code> √† l'<code>attribute</code></li>
</ul>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">‚ö†Ô∏è ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">Certaines de ces m√©thodes vont te ressortir un objet, d'autres une array. Fais donc attention avant de te lancer dans des <code>.email</code> point√©s √† des arrays ;)</p>
    </div>
  </div>
</div>



<h4>3.2.3. Tester ses models</h4>
<p>Ce pourquoi j'utilise tr√®s souvent la console est que je peux tester tr√®s rapidement si mes models sont bien li√©s entre eux. Fais-le tout le temps. Apprends √† ma√Ætriser ceci, puisque si tu sais le faire en console, tu sauras le faire dans ton programme. Voici par exemple comment tester que Book appartient bien √† Author et Author a plusieurs books :</p>

<pre><code class="language-ruby">> b = Book.new
#=> Super un book pas encore sauvegard√©
> b.author
#=> il te renvoie nil. S'il te renvoie une erreur, tu as mal suivi ce tuto
> a = Author.first
#=> un superbe auteur. S'il n'a rien, cr√©e un truc
> b.author = a
#=> pas d'erreur
> b.save
#=> COMMIT. S'il te renvoie une erreur, tu as mal suivi ce tuto
> Book.last.author.books #=> R√©cup√®re les books de l'author du dernier book que tu as en base (celui que tu viens de cr√©√©r)
#=> Devrait te renvoyer une array qui contient le book que tu viens de cr√©√©r</code></pre>


<h4>3.2.4. Bonus</h4>
<p>Puisque c'est toi, voici quelques m√©thodes en bonus que tu peux copier-coller dans ta console pour t'amuser/</p>

<h5>3.2.4.1. Cr√©er 100 users</h5>
<p>Voici quelques lignes pour cr√©er 100 utilisateurs :</p>
<pre><code class="language-ruby">100.times do |index|
	u = User.create
	u.name = "TonPr√©nom" + index.to_s
	u.email = "email_#{index}@email.com"
	u.save
end</code></pre>


<h5>3.2.4.2. Visualiser la base de donn√©es</h5>
<p>On me demande souvent si c'est possible d'utiliser un soft qui permet de visualiser sa base de donn√©es. Ce √† quoi je r√©ponds : "c'est une view dans ton app √ßa" ou alors "la console est faite pour". Pour toi, voici une astuce pour afficher la base de donn√©es dans la console en mode "gros BG de l'√©cran noir". Pour ceci, il faudra passer par la gem <a href="https://github.com/arches/table_print" target="_blank">table_print</a>. Mets-la dans ton Gemfile, puis <code>bundle install</code>, puis tu n'as plus qu'√† l'activer dans ta console avec :</p>

<pre><code class="language-ruby">tp User.all</code></pre>

<p>Avoue que c'est assez BG quand m√™me.</p>



<h2>4. Points importants √† retenir</h2>
<p>La console est ta meilleure amie. Utilise la TOUT LE TEMPS.</p>

<h2>5. Pour aller plus loin</h2>
<p>Nous te conseillons de jeter un oeil attentif √† ceci :  notre ami Jonathan a fait une <a href="https://youtu.be/UsuFC9-Irzw" target="_blank" class="text-primary">vid√©o o√π il s'amuse avec la console</a>, car la compr√©hension de la console est <b>indispensable</b> pour bien g√©rer tes mod√®les pour les prochains jours. Tu peux la regarder jusqu'√† 12:59 (il parle du controller apr√®s, et cela ne nous concerne pas pour le moment).</p>

<p>Pour plus d'informations sur les requ√™tes en ActiveRecord, la <a href="https://guides.rubyonrails.org/active_record_querying.html" target="_blank">doc</a> contient beaucoup d"info utiles (comme d'habitude).</p>

          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Seed</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>Remplir sa base de donn√©es √† la main peut √™tre fastidieux. Et si on trouvait un moyen de remplir 100 books, comme √ßa c'est la f√™te et on a juste √† siroter un caf√© pendant que notre ordinateur le fait ? Mais c'est tout bonnement l'int√©r√™t de l'informatique üéâ</p>

<p>Les seeds vont te demander de <b>bien</b> comprendre le backend puisque tu vas cr√©er plein d'√©l√©ments en base, qui doivent √™tre corrects. Ce sera une super occasion d'approfondir tes bases en backend et Model.</p>

<h2>2. Historique</h2>
<p>Boarf, y'a pas grand chose √† dire, si ce n'est que c'est la meilleure technique pour tester en local ton application.</p>

<h2>3. La ressource</h2>

<h3>3.1. Seed de base</h3>
<p>Au lieu de remplir sa BDD de dummy data √† la main, ce qui est particuli√®rement fastidieux, on peut la <b>seed</b>. C'est √† dire la remplir de donn√©es random en ex√©cutant la commande : </p>

<pre><code class="language-shell">$ rails db:seed</code></pre>

<p>Au pr√©alable, tu devras pr√©ciser ce que tu vas seeder dans le fichier <code>db/seeds.rb</code>. 

<p> Seeds.rb est comme un fichier o√π l'on peut √©crire des lignes de commande de Rails Console. Par exemple si tu √©cris √† l'int√©rieur :</p>

<pre><code class="language-ruby">User.create(name: "jean", email:"jean@jean.jean")
User.create(name: "paul", email:"paul@paul.paul")
p "Deux utilisateurs ont √©t√© cr√©√©s"</code></pre>
Et que tu fais :

<pre><code class="language-ruby">$ rails db:seed</code></pre>

<p>Rails va te cr√©er 2 utilisateurs, et t'afficher qu'il a cr√©√© 2 utilisateurs.</p>

<p>Et le programme est encore plus int√©ressant si tu fais un truc du genre :</p>

<pre><code class="language-ruby"><code>100.times do |index|
  user = User.create!(name: "Nom#{index}", email: "email#{index}@example.com")
end</code></code></pre>

<p> Bref, tu pourras trouver des tuto pour seeds <a href="http://www.railszilla.com/rails-seed-data-example/rails" target="_blank">ici</a> et <a href="https://davidmles.com/seeding-database-rails/" target="_blank">l√†</a>.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Comme tout le monde, tu vas te tromper au d√©but et devoir relancer ton programme plusieurs fois. Avant de commencer un seed, il est g√©n√©ralement bien vu de remettre sa base de donn√©es √† 0, pour √©viter l'arm√©e d'utilisateurs ayant le m√™me email. Tu peux commencer ton seed par :</p>
      <pre><code class="language-ruby">Model1.destroy_all
Model2.destroy_all
etc</code></pre>
    </div>
  </div>
</div>


<h3>3.2. Seed avec Faker</h3>
<p><a href="https://github.com/stympy/faker" target="_blank">Faker</a> est une super gem qui permet de cr√©er des faux noms √† la vol√©e. Renseigner dans le gemfile la ligne correspondante, puis apr√®s <code>bundle install</code> tu peux l'appeler dans le seed en faisant <code>require 'faker'</code>.</p>

<p>Voici un exemple de seed malin en utilisant la gem Faker : </p>
<pre><code class="language-ruby">require 'faker'
100.times do
  user = User.create!(name: Faker::Company.name, email: Faker::Internet.email)
end</code></pre>

<h2>4. Points importants √† retenir</h2>
<p>La fichier <code>db/seeds.rb</code> permet de mettre des lignes de code qui vont te faire remplir ta base de donn√©es. Une fois que ton seed est bon, tu n'as qu'√† faire <code>$ rails db:seed</code>.</p>

<p><a href="https://github.com/stympy/faker" target="_blank">Faker</a> est une super gem qui permet de cr√©er des faux noms √† la vol√©e.</p>

          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>


  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #FF4081 " >
          <h1>Projet : Faire ses premi√®res bases de donn√©es en Rails</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>

<p>Pour ce projet, on va transcrire les exercices de design de BDD d'hier vers Rails et ActiveRecord. En gros, pour chaque start-up que nous avions imagin√©, nous allons te demander de cr√©er une application Rails puis de param√©trer les models et associations pour que leur base de donn√©es soit fonctionnelle.</p>

<p>Dans un premier temps, on va prendre l'exemple du blog pour te guider dans la cr√©ation d'une base de donn√©es Rails. Ensuite, on va suivre la m√©thodologie classique chez THP¬†: on te laisse la main et tu dois r√©pliquer ce que tu as vu, en t'appuyant si n√©cessaire sur l'aide de tes pairs.</p>

<h2>2. Le projet</h2>

<h3>2.1. Notre petit blog des familles</h3>

<h4>2.1.1. Un tableau, de la r√©flexion</h4>
<p>Depuis hier, et ta premi√®re √©bauche de blog, tu n'as toujours pas vu passer d'article Medium parlant de ton concept r√©volutionnaire. Du coup tu d√©cides de repartir d'une feuille blanche : tu fais le choix de revoir ton blog pour qu'il propose des fonctionnalit√©s l√©g√®rement diff√©rentes de la pr√©c√©dente.<br>
Le concept version 2 est le suivant: c'est un super blog o√π les utilisateurs pourront s'enregistrer, cr√©er des articles, les commenter (sans pouvoir commenter les commentaires), attribuer <b>une</b> cat√©gorie √† chaque article et m√™me les liker. Mindblowing ü§Ø</p>

<p>Dans cette premi√®re √©tape, prends ta feuille / ton tableau / ton ERD et r√©fl√©chis en √©quipe √† l'organisation de ta base de donn√©es. Imagine tous les mod√®les qu'il faut pour le blog, les relations entre eux et √©videmment les attributs de chacun. On est dans une mise en situation typique d'un lancement de produit¬†: il faut concevoir en premier l'architecture de sa base de donn√©es üòá</p>

<p>√âvidemment, Jean-Michel Petit-malin va te dire "t'emmerde pas, y a un pas √† pas juste apr√®s¬†!". Certes. Apr√®s, les architectures de base de donn√©es, c'est un peu comme la voiture¬†: c'est pas en lisant le code que t'apprends √† en faire (code de la route / code informatique. Vous l'avez¬†? üëä) Il faut pratique¬†!! Au d√©but √ßa va te para√Ætre insurmontable, on est super f√©brile, on se dit qu'on y arrivera pas. Mais tr√®s vite, on prend le pli, on devient plus serein, et on se met √† faire des trucs vraiment styl√©s. Donc tu peux regarder <a href="https://www.youtube.com/watch?v=OnEcAcVPXUw" target="_blank" class="text-primary">TAXI</a> en boucle, c'est pas √ßa qui t'apprendra √† faire des <i>drifts</i> de ouf. I'm out. ‚úãüé§</p>


<h4>2.1.2. Une app Rails, et ses models</h4>
<p>Maintenant que tu as pu r√©fl√©chir par toi-m√™me, on va passer √† la pratique en construisant ensemble l'app Rails de blog avec ses models et ses associations.</p>

<h5>a) Les bases</h5>
<p>Commence par cr√©er une application Rails, puis mets les bonnes versions de Ruby et Rails dans le Gemfile.</p>

<h5>b) Les users</h5>
<p>Cr√©e un mod√®le <code>User</code>, li√© √† une table qui aura comme attributs :</p>
<ul>
  <li>Un <code>first_name</code>, qui est un string</li>
  <li>Un <code>last_name</code>, qui est un string</li>
  <li>Un <code>email</code>, qui est un string</li>
</ul>

<p>Apr√®s avoir fait ta migration, va dans la console et amuse-toi √† :</p>
<ul>
  <li>Cr√©er des utilisateurs</li>
  <li>Les sauver en BDD</li>
  <li>Changer leurs <code>first_name</code>, <code>last_name</code></li>
  <li>R√©cup√©rer certains users avec <code>User.all</code>, <code>User.first</code>, <code>User.last</code> ou <code>User.find(xxx)</code></li>
</ul> 
<p>Bien ma√Ætriser la console est <b>indispensable</b> pour bien comprendre les models et BDD en Rails¬†: donc fais-le¬†! <br>
Ensuite, cr√©e avec le seed 10 utilisateurs.</p>

<h5>c) Les articles</h5>
<p>Ajoute un model d'article. <br>
Un article a forc√©ment un auteur (qui est un user) et un user peut avoir √©crit plusieurs articles. Chaque article aura comme attributs :</p>
<ul>
  <li>Un <code>title</code>, qui est un string</li>
  <li>Un <code>content</code>, qui est un text</li>
</ul>

<p>Pour tester si ton association marche, va en console, et essaie d'ajouter √† la main des articles √† tes utilisateurs. Pour √ßa, fais un truc du genre :</p>

<pre><code class="language-ruby">u = User.first
a = Article.new
a.user = u
u.save</code></pre>

<p>Lis-bien ce que le terminal te renvoie¬†: en cas de <code>ROLLBACK</code> ou d'erreur, tu t'es tromp√©. Il faut reprendre ton mod√®le ou tes migrations.</p>


<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Parfois tu feras <code>Truc.create</code> et la console te fait un truc du genre :</p>
<pre><code class="language-ruby">> u.save
   (36.6ms)  BEGIN
   (24.4ms)  ROLLBACK</code></pre>

      <p>Tu peux faire <code>u.errors</code> pour que ActiveRecord te dise ce qui ne va pas.</p>
    </div>
  </div>
</div>

<p>√Ä nouveau, fais-toi la main avec la console et cr√©e des articles en base. C'est normal et indispensable de prendre un peu de temps pour se faire la main avec la console¬†: on est tous pass√©s par l√† et tous les devs m√™me seniors continuent de le faire üòâ</p>

<p>Finalement, cr√©e avec le fichier seed 10 articles en base de donn√©es (forc√©ment associ√©s √† un auteur chacun).</p>

<h5>d) Les cat√©gories</h5>
<p>Ajoute un model de cat√©gorie. Un article a une cat√©gorie, et une cat√©gorie peut concerner plusieurs articles. Voici ses attributs :</p>
<ul>
  <li>Un <code>name</code>, qui est un string</li>
</ul>

<p>Bien entendu, teste la cr√©ation de cat√©gorie en console, teste aussi la relation entre les cat√©gories et les articles. <br>
Finalement, cr√©e avec le seed 5 cat√©gories, puis associe tes 10 articles √† une des cat√©gories.</p>

<h5>e) Les commentaires</h5>
<p>Maintenant nous allons mettre en place un syst√®me de commentaires. Un commentaire commentera un article, et aura un auteur (qui est un utilisateur). Un utilisateur peut cr√©er plusieurs commentaires, et un article peut avoir plusieurs commentaires. Un commentaire aura comme attributs :</p>

<ul>
  <li>Un <code>content</code>, qui est un text.</li>
</ul>

<p>Sans surprise¬†: teste la cr√©ation de commentaires et leur bonne association aux users et articles depuis la console¬†! <br>
Maintenant, cr√©e dans le seed 15 commentaires, que tu assigneras √† des utilisateurs et √† des articles.</p>

<h5>f) Les likes</h5>
<p>Derni√®re √©tape de l'architecture de ta BDD, nous allons maintenant faire en sorte de pouvoir liker un article. <br>
Un like concerne un article, et est fait par un likeur (qui est un utilisateur). Un utilisateur peut avoir plusieurs likes, et un article peut avoir plusieurs likes. Le like n'aura pas vraiment besoin d'attributs donc nous n'allons pas lui en donner üòé</p>

<p>On ne change pas les bonnes habitudes¬†: tests en console puis cr√©ation de 15 likes en BDD avec le seed.</p>

<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">üöÄ ALERTE BONNE ASTUCE</h4>
      <p class="card-text">Si tu es malin, tu peux te rendre compte qu'√† travers un like, on cr√©e une sorte de lien entre un article et un utilisateur (sans qu'il s'agisse de son auteur). Ainsi un article peut avoir plusieurs <i>likeurs</i> (utilisateurs), et un utilisateur peut avoir plusieurs <i>articles lik√©s</i> (articles). <br>
      <b>Mais, mais, mais, cela ne ressemblerait pas √† une relation N-N entre articles et utilisateurs √ßa¬†?</b> Exactement chef¬†! ü§† <br>
      Tu viens d'avoir une illustration de la fa√ßon dont on g√®re une relation N-N dans Rails : gr√¢ce √† une table interm√©diaire entre deux tables (la table <code>likes</code> dans notre cas), et quelques lignes d'association dans les models. C'est aussi simple que cela. Bref, nous verrons ceci plus en d√©tails demain, mais je pense que tu as compris l'astuce ü§ì</p>
    </div>
  </div>
</div>


<h5>g) Faker</h5>
<p>Allez, OKLM, puisque que t'es arriv√© au bout¬†: utilise la gem Faker pour faire en sorte que les attributs des diff√©rents models soient (vaguement) plausibles (les p√©tages de plomb √† base de Chuck Norris Facts sont autoris√©s ü§™). <br>
Va donc ‚Äîl√©g√®rement‚Äî modifier ton seed pour que la cr√©ation de chaque entr√©e en BDD contienne du faker et soit plus stylay.</p>


<h3>2.2. On d√©roule sur nos 4 autres startups</h3>
<p>Tu te souviens de MOOCademy, The Hacking Pinterest, The Hacking News et The Hacking Class¬†? Eh bien en repartant du travail de conception de BDD que tu avais effectu√©, cr√©e une application Rails pour chacun avec les models, tables, associations et attributs qui vont bien. <br>
Compl√®te le tout avec des seed en Faker, teste tout bien en console et le tour est dans le sac¬†!</p>


<h2>3. Rendu attendu</h2>
<p>Aujourd'hui, tu t'es mu√© en cr√©ateur prolifique de start-ups. Il faudra nous soumettre 5 liens¬†: </p>
<ul>
  <li>Un lien GitHub pour l'app Rails du blog</li>
  <li>Un lien GitHub pour l'app Rails de MOOCademy</li>
  <li>Un lien GitHub pour l'app Rails de The Hacking Pinterest</li>
  <li>Un lien GitHub pour l'app Rails de The Hacking News</li>
  <li>Un lien GitHub pour l'app Rails de The Hacking Class</li>
</ul>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>



</div>


  </div>
</div>
    <script src="/packs/dashboard-031178fac0de4f91cbcc.js"></script>
    

    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  </body>
</html>
