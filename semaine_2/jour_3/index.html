<!DOCTYPE html>
<html class="loading" lang="fr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="../../style/bootstrap.css">
    <title>The hacking project offline</title>
  </head>
  <body class="vertical-layout vertical-menu 2-columns  menu-expanded fixed-navbar" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns">
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <h1 class="navbar-brand">THE HACKING PROJECT</h1>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarColor01">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="../../">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../features">Features</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="../../about">About</a>
            </li>
          </ul>
          <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search">
            <button class="btn btn-secondary my-2 my-sm-0" type="submit">Search</button>
          </form>
        </div>
      </nav>

<div class="container">
    <a type="button" class="btn btn-dark" href="../../semaine_1/">Semaine 1</a>
    <a type="button" class="btn btn-dark btn-lg" href="../../semaine_2/">Semaine 2</a>
    <a type="button" class="btn btn-dark" href="../../semaine_3/">Semaine 3</a>
    <a type="button" class="btn btn-dark" href="../../semaine_4/">Semaine 4</a>
    <a type="button" class="btn btn-dark" href="../../semaine_5/">Semaine 5</a>  
</div>

<div class="app-content content">
  <div class="content-wrapper">
    <div class="content-wrapper-before"></div>
    <div class="content-header row"></div>
    
      <div class="container">
    <div class="card">
  <div class="card-header">
    <h4 class="text-center"> Programme jour par jour</h4>
  </div>
  <div class="card-body">
    <div class="text-center">
    <a href="../../semaine_2">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
        <i class="fa fa-terminal"></i>&nbsp;&nbsp;&nbsp;Lun
      </button>
</a>    <a href="../../semaine_2/jour_2">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
        <i class="fa fa-code"></i>&nbsp;&nbsp;&nbsp;Mar
      </button>
</a>    <a href="../../semaine_2/jour_3">
      <button class="btn btn-secondary btn-outline-dark btn-lg mr-4">
        <i class="fa fa-desktop"></i>&nbsp;&nbsp;&nbsp;Mer
      </button>
</a>    <a href="../../semaine_2/jour_4">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
      <i class="fa fa-folder-open"></i>&nbsp;&nbsp;&nbsp;Jeu
      </button>
</a>    <a href="../../semaine_2/jour_5">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
      <i class="fa fa-bullhorn"></i>&nbsp;&nbsp;&nbsp;Ven
      </button>
</a>    </div>
  </div>
</div>

<div class="app-content content">
  <div class="content-wrapper">
    <div class="content-wrapper-before"></div>
    <div class="content-header row"></div>
    
      
<div class="content-body">
      <h2 class="text-center">Bot Twitter</h2>
      <h4 class="text-center">Découverte de Ruby</h4>
  <div class="row">
     <div class="col-xl-3 col-lg-6 col-md-12">
  <div class="card">
    <div class="card-content">
      <div class="card-body">
        <div class="media d-flex">
          <div class="align-self-top">
              <i class="ft-calendar icon-opacity info font-large-4"></i>
          </div>
          <div class="media-body text-right align-self-bottom mt-3">
              <span class="d-block mb-1 font-medium-1"></span>
              <h3 class="info mb-0">
                 Jour 24 / 55</h3>
          </div>
        </div>
        <div class="progress progress-sm mt-1 mb-0 box-shadow-2">
            <div class="progress-bar bg-gradient-x-info" role="progressbar" style="width: 43%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="120">
            </div>
        </div>
      </div>
    </div>
  </div>
 </div>


    <div class="col-xl-3 col-lg-6 col-md-12">
  <div class="card">
    <div class="card-content">
      <div class="card-body">
        <div class="media d-flex">
          <div class="align-self-top">
            <i class="ft-heart icon-opacity danger font-large-4"></i>
          </div>
          <div class="media-body text-right align-self-bottom mt-3">
            <span class="d-block mb-1 font-medium-1">Jokers restant</span>
            <h3 class="danger mb-0">
                3
            </h3>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

    <div class="col-xl-3 col-lg-6 col-md-12">
    <div class="card">
        <div class="card-content">
            <div class="card-body">
                <div class="media d-flex">
                    <div class="align-self-top">
                        <a href="/dashboard/assignments?locale=fr">
                           <i class="ft-fast-forward icon-opacity warning font-large-4"></i>
</a>                    </div>
                    <div class="media-body text-right align-self-bottom mt-3">
                        <span class="d-block mb-1 font-medium-1">Missions</span>
                            <div class="badge border-danger danger badge-border">Pas inscrit</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

  </div>
  <div class="row">
        <div class="container">
    <div class="col-xl-12 col-lg-12 col-md-12">
    <div class="card">
        <div class="card-header">
        <h1 >Découverte de Ruby
                <i class="fa fa-beer text-warning"></i>
        </h1>
        
        </div>
        <div class="card-content">
        <div class="card-body">
            <div class="card-text">
            <h2 class="text-center">Bot Twitter</h2>
            <div class="cd-horizontal-timeline loaded">
                <div class="timeline">
                <div class="events-wrapper">
                    <div class="events" style="width: 1800px;">
                    <ol>
                                <li>
                                    <a style="left:120px;" href="/dashboard/weeks/2/days/1?locale=fr">
                                        Lun
                                            <i class="fa fa-rocket text-danger" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Projet à rendre ce jour-là"></i>

</a>                                </li>
                                <li>
                                    <a style="left:240px;" href="/dashboard/weeks/2/days/2?locale=fr">
                                        Mar
                                            <i class="fa fa-pencil text-success" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Corrections cette journée là" ></i>


</a>                                </li>
                            <li>
                                <a class="selected" style="left:360px;" data-toggle="tooltip" data-placement="top" title="Bot Twitter" href="/dashboard/weeks/2/days/3?locale=fr">
                                    Mer
                                        <i class="fa fa-beer text-warning" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Rendez-vous pour boire un coup"></i>

</a>                                </li>
                                <li>
                                    <a style="left:480px;" href="/dashboard/weeks/2/days/4?locale=fr">
                                        Jeu
                                            <i class="fa fa-rocket text-danger" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Projet à rendre ce jour-là"></i>

</a>                                </li>
                                <li>
                                    <a style="left:600px;" href="/dashboard/weeks/2/days/5?locale=fr">
                                        Ven
                                            <i class="fa fa-pencil text-success" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Corrections cette journée là" ></i>


</a>                                </li>
                    </ol>
                </div>
                </div>
            </div>
            </div>
        </div>
        </div>
    </div>
    </div>
<div>
  </div>

  <!-- Les fameuses corrections qui n'arrivnet que les jours concernés -->


    <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Débugger et la gem PRY</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>Nous allons te montrer <a href="https://github.com/pry/pry" target="_blank">PRY</a>, une gem extrêmement pratique qui permet de débugger du code très facilement. Nous allons aussi en profiter pour t’apprendre à bien débugger tes programmes car, comme pour tout, « il y a des bonnes pratiques pour ça ».</p>

<h2>2. Historique</h2>
<p>La gem PRY a été créée par John Mair. Le debuggin a, lui, été inventé le jour où le premier programme a été exécuté.</p>

<h2>3. La ressource</h2>
<h3>3.1. Introduction au debugging</h3>
<p>PRY est une gem extrêmement pratique quand tu n’arrives pas à diagnostiquer l’origine d’un bug. La plupart du temps, quand ton programme plante, il s’arrête en te balançant un message d’erreur plus ou moins explicite. Pour ne pas te laisser gagner par le désarroi, voici une petite méthode pas-à-pas pour apprendre à débugger :</p>
<ol>
  <li>La première étape est de <b>toujours essayer de lire le message d’erreur et tenter de le comprendre</b> (pense à ce pauvre message d’erreur : on veut tous être compris). En effet, il t’indiquera souvent l’origine de l'erreur (méthode non définie, variable dont la valeur est <i>Nil</i>, etc.). Et surtout la ligne où elle a lieu ! Au début c’est fastidieux mais à force de les décoder, tu vas devenir bilingue en LV2 "message de bug".</li>
  <li>N’hésite pas à faire une <b>petite recherche Google</b> sur le texte d'erreur : StackOverFlow regorge de gens qui l'ont eu avant toi et à qui on a expliqué le problème qui était lié.</li>
  <li>Après la lecture du message, une recherche Google, et une petite connaissance de ton code, tu devrais au moins être capable de circonscrire le bug à une étape précise de ton code : <b>tu vas la remplir de <code>puts</code></b>. Et si tu n'as rien identifié, eh bien mets en partout ! L'objectif est d'afficher la valeur de tes variables ou méthodes. Ça te permettra de trouver celle dont le <code>puts</code> n'affiche rien (la variable / méthode retourne Nil ? Ou alors ton puts n'est même pas exécuté, car le code n'est pas lu ?) ou dont le <code>puts</code> n'a pas la bonne valeur.</li>
  <li>Une fois ces 2 étapes faites mais ne donnant aucun résultat, tu peux aller chercher de l'aide auprès d'un ami hackeur ou sur le Slack. Une bonne règle de trois est la suivante :  <b>PAS MOINS de 5-10 minutes à essayer de te débrouiller seul (tu dois apprendre à débugger) mais PAS PLUS de 20-30 minutes bloqué tout seul (ça veut dire que tu tournes en rond)</b>.</li>
</ol> Le debugging via <code>puts</code> est une technique géniale et permet de résoudre très rapidement un problème. J'ai même un adage : "dans le doute, fous des <code>puts</code>" que tu devrais suivre en toute circonstance.</p>

<p>Mais il se trouve que des fois tu n'as pas envie que ton programme se relance toutes les deux minutes pour le tester (exemple : un programme de scrapping qui met 4 minutes à s’exécuter de bout en bout et bugue vers la fin), ou bien tu es tellement paumé dans ton code que tu as besoin de vérifier toutes les variables, voire de tester à la main les méthodes dans ton programme. Eh bien avec PRY, tu peux lancer un REPL (tu sais, les programmes du genre de IRB) en plein milieu de ton programme, juste avant qu'il plante, tester tes variables, tes lignes de code, et ainsi trouver d'où vient ton erreur.</p>

<p>Afin de comprendre ce que fait PRY, et avoir quelques bonnes pratiques sur le debugging, nous avons sélectionné <a href="https://www.youtube.com/watch?v=dPDrgpWakrA" target="_blank" class="text-primary">un petit tutoriel vidéo</a> qui explique en 12 minutes comment utiliser la gem PRY.</p>

<h3>3.2. Utiliser la gem PRY</h3>
<p>Pour utiliser, il faut d'abord ajouter PRY à ton Gemfile :</p>

<pre><code class="language-ruby">gem 'pry'</code></pre>

<p>Ensuite, tu auras besoin d'appeler PRY dans ton programme :</p>

<pre><code class="language-ruby">require 'pry'

# le reste de ton programme…</code></pre>

<p>Et voilà, tu auras juste à insérer <code>binding.pry</code> pour que le REPL s'exécute à cet endroit du code. C'est comme si IRB se lançait au milieu de l'exécution de ton code et que du coup, tu pouvais interagir avec les variables et méthodes dans leur état actuel. Par exemple, en exécutant le code suivant :</p>
<pre><code class="language-ruby">require 'pry'

def multiply_by_6(var) #définition d'une méthode multipliant par 6 en 2 étapes
var = var * 2
binding.pry # On lance PRY au milieu de la méthode
var = var * 3
return var
end

multiply_by_6(5) # j'exécute la méthode sur la valeur 5</code></pre>

<p>On lance le programme et PRY s'exécute sous la forme d'une fenêtre type IRB. Si on veut afficher la valeur de <code>var</code>, on obtient <code>=> 10</code>, la valeur de (5 x 2).</p>



<h2>4. Points importants à retenir</h2>
<p>Pour débugger : 1) lis les messages 2) cherche sur Google 3) mets des puts / utilise PRY 4) appelle un ami.</p>
<p>PRY permet de lancer une sorte d'IRB en plein milieu d'un programme Ruby. Cette interface permet de faire une pause dans l'exécution du programme et de tester la valeur de toutes les variables ou méthodes que l'on souhaite. C'est un outil extrêmement puissant pour débugger un programme et interagir avec.</p>

<p>Pour utiliser PRY, il faut ajouter <code>gem 'pry'</code> dans son Gemfile, <code>require 'pry'</code> en haut de ton programme concerné, puis <code>binding.pry</code> pour exécuter PRY dans ton code.</p>

<h2>5. Pour aller plus loin</h2>
<p>Tu peux aller sur <a href="http://pryrepl.org/" target="_blank">le site de PRY</a>, ou tu peux aller jeter un œil sur la documentation de <a href="https://github.com/pry/pry" target="_blank" class="text-primary">PRY sur GitHub</a>.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Dotenv</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>Aujourd'hui, tu vas apprendre à manipuler des clés d'API. Les clés d'API sont en quelque sorte tes identifiants et mots de passe pour faire communiquer tes programmes avec un programme tiers (Twitter, Google Drive, Spotify, etc.). Le hic, c'est que si tu écris tes identifiants dans un programme que tu vas ensuite push sur GitHub (où il est public et donc lisible par tous), c'est le meilleur moyen de faire usurper ton identité sur les API. <br> Il existe d'ailleurs moult bots qui s'amusent à aller sur tout GitHub et récupérer les identifiants des développeurs maladroits. En les utilisant, ils peuvent alors profiter des services à ta place (surtout si ce sont des services payants) ou commettre des délits en ton nom. Sympa non ? Bienvenue sur le net. 🏴‍☠️ </p>

<p>Dans cette ressource, nous allons te montrer comment arriver à manipuler très facilement des clés d'API, tout en les gardant secrètes, grâce à la gem Dotenv !</p>


<h2>2. Historique</h2>
<p>Un moussaillon s'est retrouvé avec une facture Amazon de 16 000€ pour avoir mis ses clefs d’API sur GitHub sans passer par Dotenv (Amazon Web Services exige souvent une carte bleue avant de te donner un accès). OK, c'est plutôt une anecdote mais j'avais pas d'historique à te proposer sur Dotenv 😇.</p>

<h2>3. La ressource</h2>
<p>Dotenv est une gem qui permet de stocker des clés d'API dans un joli fichier qui va rester secret, car il ne sera jamais push sur GitHub. Via la gem, ton programme pourra faire appel au contenu de ce fichier pour utiliser les clés.</p>

<h3>3.1. Comment ça marche ?</h3>

<p>On va mettre toutes les clés d'API dans un fichier <code>.env</code> (c'est le nom complet du fichier), puis on pourra les appeler en faisant <code>ENV['NOM_DE_LA_CLÉ']</code> dans notre programme Ruby. Puis afin d'éviter de pousser le bousin sur GitHub, on va rajouter le nom du fichier <code>.env</code> dans le texte de notre <code>.gitignore</code></p>

<h3>3.2. Exemple avec un dossier Ruby simple</h3>
<p>Il faut commencer par ajouter la gem dans le Gemfile :</p>

<pre><code class="language-ruby">gem 'dotenv'</code></pre>

<p>Ensuite, on va créer un fichier <code>.env</code> qui contiendra nos clés d'API, ou autres éléments secrets :</p>

<pre><code class="language-ruby">TWITTER_API_KEY="my-twitter-api-key"
TWITTER_API_SECRET="this_is_soooo_secret"

BEST_WEBSITE_EVER="thehackingproject"</code></pre>

<p>En appelant la gem Dotenv, tout fichier Ruby dans le dossier pourra accéder à ces données. Voici un exemple de programme qui accède aux clés d’API :</p>

<pre><code class="language-ruby">require 'dotenv'# Appelle la gem Dotenv

Dotenv.load('.env') # Ceci appelle le fichier .env (situé dans le même dossier que le programme Ruby) grâce à la gem Dotenv, et importe toutes les données enregistrées dans un hash ENV

# Il est ensuite très facile d'appeler les données du fichier .env, par exemple là je vais afficher le contenu de la clé TWITTER_API_SECRET
puts ENV['TWITTER_API_SECRET']

# tout est stocké dans un hash qui s'appelle ENV. Tu peux le regarder en faisant :
puts ENV</code></pre>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">⚠️ ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">Ouiiiin, Dotenv ça marche paaaas ! 😭</p>
      <p>Voici les principales coquilles que les moussaillons font et qui empêchent la gem de bien faire son boulot :</p>
      <ul>
        <li>Le fichier <code>.env</code> est mal nommé ou pas situé dans le même dossier que le fichier Ruby que tu exécutes. Dans ce cas, il te faut préciser à Dotenv où ton <code>.env</code> est situé. Par exemple pour lui dire ".env est un dossier plus haut que mon fichier Ruby", utilises la ligne <code>Dotenv.load('../../.env')</code></li>
        <li>Dans le fichier <code>.env</code>, les clés d'API ne sont pas définies comme des strings. Il faut les déclarer ainsi : <code>Nom_de_la_clef = "contenu de la clé"</code>. Si vous oubliez les guillemets, ça foire.</li>
        <li>Dans ton programme, la clé d’API n'est pas bien appelée. C'est un string à appeler sur le hash <code>ENV</code> pour en obtenir la valeur. Avec l'exemple précédent, je dois écrire <code>ENV['Nom_de_la_clef']</code> (encore une fois, n'oubliez pas les guillemets).</li>
        <li>Dans le doute, fais un <code>puts ENV['Nom_de_la_clef']</code> et vérifie que tu obtiens bien ta clef à l'écran !</li>
      </ul>
    </div>
  </div>
</div>

<p>Et <b>avant de faire un commit et de push sur Github</b>, nous allons rajouter le nom du fichier <code>.env</code> dans le texte de notre <code>.gitignore</code>. Ainsi, ce fichier ne sera pas push sur Github : si une autre personne veut l’obtenir, il faudra lui envoyer par e-mail ou par Slack. Pour faire ça, ajoute la ligne suivante dans un fichier qui s'appelle <code>.gitignore</code> :</p>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">⚠️ ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">N'oublie pas cette étape d'ajout dans le <code>.gitignore</code> ! Sinon tout ça n'aura servi à rien et tu vas push <code>.env</code> sur GitHub … Et les hackers te disent merci.</p>
    </div>
  </div>
</div>

<pre><code class="language-ruby">.env</code></pre>

<p>Et voilà, ton dossier type devrait ressembler à ceci :</p>

<pre><code class="language-shell">mon_projet
├── lib
│   └── app.rb
├── spec
│   ├── spec_helper.rb
│   └── app_spec.rb
├── README.md
├── Gemfile
├── Gemfile.lock
├── .env
├── .gitignore
└── .rspec</code></pre>



<h2>4. Points importants à retenir</h2>
<p>Pour utiliser Dotenv, ajoute <code>gem 'dotenv'</code> à ton Gemfile, puis créé un fichier <code>.env</code> qui contiendra tes clés d'API et qui sera listé dans le texte de ton <code>.gitignore</code>.</p>
<p>Tu auras juste à <code>require 'dotenv'</code> et <code>Dotenv.load</code> pour avoir accès au contenu du fichier dans tes programmes Ruby.</p>
<p>Une cheatsheet Dotenv est <a href="https://github.com/codeunion/dotenv-example" target="_blank">disponible ici</a>.</p>


<h2>5. Pour aller plus loin</h2>
<p>Tu peux <a href="https://github.com/bkeepers/dotenv" target="_blank">jeter un œil</a> sur le repo de la gem Dotenv.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Gem Twitter</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          
<h2>1. Introduction</h2>
<p>Bon, maintenant que tu sais compter jusqu'à 100 et que tu commences à bien comprendre les hash et les arrays, nous allons pouvoir faire des programmes plus funky que ceux qui comptent des mots ou font des pyramides sur terminal.</p>

<p>Ainsi, dans cette ressource, nous allons voir comment communiquer avec l'API de Twitter pour que ce soit des programmes Ruby qui gazouillent à ta place. Prépare la table d'opération : tu vas bientôt donner vie à ton premier robot-Twitter personnel ! 😎</p>

<h2>2. Historique</h2>
<p>Une <i>interface de programmation applicative</i> (Application Programming Interface, ou <b>API</b> en anglais) est un set de fonctions qui permet de communiquer avec un programme informatique. Par exemple, si l’interface web de Gmail permet d'envoyer un e-mail en cliquant sur le bouton "Envoyer", il est possible de faire la même chose en faisant un <code>email.send</code> via un programme Ruby connecté à l'API de Gmail (je caricature, mais c'est à peu près cela).</p>

<p>Les APIs sont indispensables si l'on veut faire travailler des programmes à notre place et ainsi automatiser des tâches. Par exemple, tu crées une start-up qui propose un abonnement à une box de PQ, qui envoie tous les mois une sélection des meilleurs PQ, moyennant 10 € mensuels. Tu pourrais te connecter à <a href="https://dashboard.stripe.com/dashboard" target="_blank">ton compte Stripe</a>, puis cliquer tous les mois sur le bon bouton pour prélever de 10 € tes clients, et enfin envoyer ta super box si leur carte bleue passe. On a là une tâche sans valeur ajoutée, répétitive, que tu effectues sur un site web (autrement dit un programme informatique) : c'est typiquement le genre de chose qu'il faut automatiser par API. Laisse les bots bosser pour toi en faisant un <code>User.all.each { |u| u.pay(10) }</code> : ils adorent se parler entre eux.  🤖♥🤖 </p>

<p>Pour cette ressource, nous allons te montrer comment te connecter à l'API de Twitter, et envoyer ton premier tweet.</p>


<h2>3. La ressource</h2>
<h3>3.1. Gem Twitter et API Twitter : quelle différence ?</h3>
<p>Twitter possède <a href="https://developer.twitter.com/en/docs.html" target="_blank">une API</a> très documentée via laquelle il est possible de faire plein d'actions (tweet, like, follow, search, etc.). En théorie, une API nécessite de coder des requêtes HTTP un peu complexes pour tout faire marcher : c'est potentiellement long et pas si simple pour un débutant. <br> Heureusement, pour la majorité des gros sites connus, tu pourras trouver des wrappers d'APIs en Ruby : ce sont, en gros, des gems qui ont transformé les requêtes HTTP en méthodes Ruby pour faciliter l'usage de l'API. Evidemment, <a href="https://github.com/sferik/twitter" target="_blank"> Twitter possède sa gem</a>.</p>

<h3>3.2. Grandes lignes de fonctionnement</h3>
<p>Ajoute donc la gem Twitter dans ton Gemfile, et te voici prêt à l'utiliser. À partir de là, ton programme va marcher avec les trois parties suivantes :</p>

<ul>
  <li>D'abord il va appeler la gem Twitter (ça tu commences à connaître avec <code>require</code>).</li>
  <li>Puis il va se connecter à Twitter (tu montres patte-blanche avec tes clés d'API).</li>
  <li>Enfin, une fois connecté tu pourras t’amuser avec Twitter en appelant tout un tas de fonctions.</li>
</ul>

<p>Et en langage code, ces trois parties vont donner :</p>

<pre><code class="language-ruby"> # ligne très importante qui appelle la gem.
require 'twitter'

# n'oublie pas les lignes pour Dotenv ici…

# quelques lignes qui appellent les clés d'API de ton fichier .env
client = Twitter::REST::Client.new do |config|
  config.consumer_key        = ENV["TWITTER_CONSUMER_KEY"]
  config.consumer_secret     = ENV["TWITTER_CONSUMER_SECRET"]
  config.access_token        = ENV["TWITTER_ACCESS_TOKEN"]
  config.access_token_secret = ENV["TWITTER_ACCESS_TOKEN_SECRET"]
end

# ligne qui permet de tweeter sur ton compte
client.update('Mon premier tweet en Ruby !!!!')</code></pre>
<p>Nous allons maintenant voir chaque fonctionnalité de la gem en détail.</p>

<h3>3.2. Étape d'authentification</h3>
<p>En théorie, l'application que tu as soumise à Twitter (il y a quelques jours) doit être maintenant validée, et tu as accès à des clés d'API. Il y a en 4 :</p>

<ul>
  <li>Consumer Key</li>
  <li>Consumer Secret</li>
  <li>Access Token</li>
  <li>Access Token Secret</li>
</ul>

<p>Maintenant que tu as ces clés, mets-les dans ton fichier <code>.env</code> sous les noms <code>TWITTER_CONSUMER_KEY</code>, <code>TWITTER_CONSUMER_SECRET</code>, <code>TWITTER_ACCESS_TOKEN</code> et <code>TWITTER_ACCESS_TOKEN_SECRET</code>.N'oublie évidemment pas d'ajouter ces deux lignes magiques en haut de ton programme :</p>

<pre><code class="language-ruby">require 'dotenv'
Dotenv.load</code></pre>



<h3>3.3. Les fonctionnalités de base</h3>
<p>Maintenant tu as tout bien branché, nous pouvons faire notre premier tweet avec :</p>

<pre><code class="language-ruby">client.update('Mon premier tweet en Ruby !!!!')</code></pre><br>
<p>Tes followers vont halluciner 🤩</p>

<p>Tweeter, c'est sympa. Mais tu peux faire d'autres choses avec la gem : tu peux follow un utilisateur, récupérer la liste de tweets d'un utilisateur, et bien d'autres. Regarde <a href="https://github.com/sferik/twitter#usage-examples" target="_blank">les exemples</a> de la gem Twitter.</p>

<p>Tu peux aussi <a href="https://www.rubydoc.info/gems/twitter" target="_blank">regarder la doc officielle</a> de la gem Twitter. Les documentations des gems Ruby sous ce format peuvent paraître un peu barbares au début, mais on s'y fait très rapidement. À gauche, tu pourras trouver la liste des objets sur lesquels tu peux appliquer des méthodes. Par exemple, tu peux regarder <a href="https://www.rubydoc.info/gems/twitter/Twitter/User" target="_blank">la liste des méthodes liées aux utilisateurs</a>, et tu peux voir qu'il est possible d'avoir <a href="https://www.rubydoc.info/gems/twitter/Twitter/User" target="_blank">la localisation d'un utilisateur</a> en faisant <code>user.location</code>.</p>


<h3>3.4. Et les tests dans tout cela ?</h3>
<p>On rentre dans une partie funky pour les tests : comment tester une gem ? Déjà pour tester les programmes simples c'est pas facile, mais alors avec une gem c'est gloup. On va te montrer un exemple ou deux pour la forme, et l'on ne te demandera pas beaucoup plus pour le moment :)</p>

<h4>3.4.1. Tester la connexion</h4>
<p>Une connexion à Twitter se résume aux lignes suivantes :</p>

<pre><code class="language-ruby">client = Twitter::REST::Client.new do |config|
  config.consumer_key        = ENV["TWITTER_CONSUMER_KEY"]
  config.consumer_secret     = ENV["TWITTER_CONSUMER_SECRET"]
  config.access_token        = ENV["TWITTER_ACCESS_TOKEN"]
  config.access_token_secret = ENV["TWITTER_ACCESS_TOKEN_SECRET"]
end</code></pre>

<p>En gros, si ta connexion marche, c'est que la variable <code>client</code> ne sera pas égale à <code>nil</code>. Par exemple, si ta connexion marche, la ligne <code>puts client</code> devrait te ressortir un truc du genre <code>Twitter Object truc</code> et <code>nil</code> si cela ne marche pas.</p>

<p>Pour tester ces lignes (qui seront bien entendu imbriquées dans une méthode <code>login_twitter</code> qui devra <code>return client</code>), nous allons faire :</p>

<pre><code class="language-ruby">describe "the login_twitter method" do
  it "should return client, and client is not nil" do
    expect(login_twitter).not_to be_nil
  end
end</code></pre>

<p>Ce test dit : "ce que return la méthode login_twitter ne doit pas être égal à <code>nil</code>". Simple, efficace. Des fois il ne faut pas se prendre la tête, surtout quand on débute en code.</p>

<h4>3.4.2. Tester le tweet</h4>
<p>Bon là c'est un petit peu plus tendu. Si ton programme a bien marché, c'est qu'il a réussi à envoyer un tweet. Le souci est que tu n'as pas forcément envie d'envoyer un tweet pour tester ton programme en amont avec Rspec. Imagine un autre cas extrême : tu ne voudrais pas tester une méthode <code>send_email_to_all_users</code> qui va spammer tous tes utilisateurs. Ainsi, nous ne testerons pas cette méthode aujourd'hui : tu verras plus tard avec Rails les astuces des tests de gems.</p>


<h3>3.5. Quelques rappels et astuces de pro</h3>
<p>Maintenant que tu as balancé ton premier "Hello world" sur Twitter, on va te laisser écrire ton bot Twitter. Mais avant de te lâcher dans la nature, puisque nous ne sommes pas des monstres : voici quelques conseils.</p>

<h4>3.5.1. Clés d'API et GitHub => Dotenv</h4>
<p>On ne le répétera jamais assez : <b>il ne faut JAMAIS push sur un repo GitHub public vos clés d'API</b>. Si tu as peur de donner ton numéro de téléphone à Twitter mais que tu balances tes clés d'APIs en public, inverse vite ces habitudes pour éviter de te retrouver avec des factures bizarres, toutes tes données accessibles où simplement de voir ton compte tweeter des pubs de fausses Ray-Ban.</p>

<h4>3.5.2. PRY</h4>
<p>Au début, ton bot Twitter risque de se péter et balancer des erreurs à chaque exécution. Ainsi, utiliser Pry pour avancer à tâtons dans ton programme et avoir la main dessus est plus que recommandé. Cela te sera utile pour deux raisons :</p>

<ol>
  <li>Tu vas avancer bien plus vite, car tu testes très rapidement si tes lignes sont valables.</li>
  <li>Pas besoin de redémarrer ton programme quand tu auras un bug. Au bout d'un certain nombre de <code>Twitter::REST::Client.new</code>, Twitter bloque ton compte pour 5-10 minutes. Et si tu fais trop de <code>client.update</code>, il va carrément te bloquer. Ceci est dû au fait qu'ils veulent éviter les robots spammeurs : <code>binding.pry</code> permet d'éviter de redémarrer tout ton programme, avec des <code>puts</code> qui cherchent un bug, évitant ainsi de te faire bloquer définitivement…</li>
</ol>


<h2>4. Points importants à retenir</h2>
<p>Grâce aux APIs, il est possible d'utiliser les fonctionnalités d'un service en se connectant dessus. Twitter possède une API et il existe <a href="https://github.com/sferik/twitter" target="_blank">une gem</a> qui permet de l'utiliser très facilement.</p>

<p>Pour faire marcher un programme avec la gem, il faut les 4 clefs d'API dans un <code>.env</code>. Ensuite, le programme-type ressemble à ça :</p>
<pre><code class="language-ruby">require 'twitter'
  require 'dotenv'

  Dotenv.load

client = Twitter::REST::Client.new do |config|
  config.consumer_key        = ENV["TWITTER_CONSUMER_KEY"]
  config.consumer_secret     = ENV["TWITTER_CONSUMER_SECRET"]
  config.access_token        = ENV["TWITTER_ACCESS_TOKEN"]
  config.access_token_secret = ENV["TWITTER_ACCESS_TOKEN_SECRET"]
end

client.update('Mon premier tweet en Ruby !!!!')</code></pre>
<p> Il existe plein d'exemples <a href="https://github.com/sferik/twitter" target="_blank">dans le README de la gem</a>. Pour implémenter des tests, on te demandera aujourd'hui de simplement tester la méthode <code>login_twitter</code>.</p>

<p>Enfin, ne mets jamais tes clés d'API en clair dans un repo GitHub, et pense à bien utiliser la gem PRY pour débugger facilement ton programme.</p>


<h2>5. Pour aller plus loin</h2>
<p>Pour découvrir l'univers des APIs, Zapier a écrit <a href="https://zapier.com/learn/apis/" target="_blank">un super livre</a> à ce sujet.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>


  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #FF4081 " >
          <h1>Projet : Bot Twitter</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          
<h2>1. Introduction</h2>
<p>Dans ce projet, tous les moussaillons de THP vont se donner la main pour changer Internet et les réseaux sociaux. On va promouvoir tous ensemble la joie, la bonne humeur et la politesse ! Il est très important de dire bonjour et vous allez populariser le hashtag <code>#bonjour_monde</code> au près du plus grand nombre.</p>

<p>Tu vas donc coder un bot Twitter, et l'objectif est de faire au mieux la promotion du <code>#bonjour_monde</code>.</p>

<h2>2. Le projet</h2>
<p>Il va sans dire que ce programme devra checker toutes les cases d'un programme Ruby propre :</p>
<ul>
  <li>Utiliser un Gemfile, dans lequel tu pourras trouver les gems dont tu te serviras pour l'exercice : Ruby avec la bonne version, Twitter, Rubocop, Pry, Rspec et Dotenv.</li>
  <li>Une architecture de dossier type (lib, spec, etc.).</li>
  <li>Un fichier <code>.env</code> dans le <code>.gitignore.</code></li>
  <li>Un README.md qui explique bien les choses</li>
</ul>
</p>

<h3>2.1. Il va dire bonjour</h3>
<p>Les journalistes sont quasiment les derniers qui croient que Twitter, c'est encore cool : ils sont tous sur la plateforme. Profitons-en ! Fais un bot Twitter qui va contacter les journalistes et promouvoir notre super hashtag. Voici une liste de handles (= noms d'utilisateurs sur Twitter) de journalistes :</p>

<pre><code class="language-ruby">["@jcunniet", "@Aziliz31","@ssoumier","@marionsouzeau","@gaellombart","@bendarag","@AurelieLebelle","@julienduffe","@thomaspoupeau","@LilyRossignol","@ClairGuedon","@stephanieauguy","@claw_prolongeau","@_JulieMenard","@LColcomb","@Zlauwereys","@MeLonguet","@DorotheeLN","@NolwennCosson","@ADaboval","@Remibaldy","@bderveaux","@amandechap","@ELODIESOULIE","@nbongarcon","@HeloAb","@gregplou","@BenoitBerthe","@LauraBruneau89","@Anthony_Lieures","@Sharonwaj","@mcsonkin","@pverduzier","@emiliel3","@Julien_MARION","@SophiFay","@bdelombre","@annalecerf","@AdriaBudry","@DejNikolic","@iJaffre","@CyrusleVirus","@GPardigon","@e_vallerey","@IsabelleSouquet","@AudeDavidRossi","@Yoann_Pa","@CeliaPenavaire","@perraultvincent","@cboulate","@JustineWeyl","@Paulinejacot","@juliechab","@aslechevallier","@phnou","@Seb_Pommier","@Alex_Bensaid","@GuillaumeGaven","@annelaurechouin","@Oliviader","@guerricp","@JMMarchaut","@cyceron","@gregory_raymond","@vhunsinger","@l_peillon","@fannyguinochet","@EAssayag","@YvonHerry","@JohanGarciajg","@saidlabidi","@lauranneprov","@LeaDavy","@francois_remy","@CGuicheteau","@FloMaillet","@m_perroud","@oBrunet_TSMF","@MoonVdc","@jc2taille","@NellyMoussu","@VirginK","@b_misa","@FabriceCouste","@barbara_prose","@lelia2m","@brunoaskenazi","@laurenechamp","@ysisbox","@juliengagliardi","@PierreLel","@kdeniau","@_TerraInc","@DominicArpin","@antoinfonteneau","@nanotousch","@jb_roch","@YaniKhezzar","@Anne_Bechet","@NCapart","@SamyBenNaceur","@Joumany","@Julietteraynal","@TGiraudet","@SaraTanit","@HappeFrederic","@antoinellorca","@michelpicot","@Sev_Ryne","@bobdobolino","@murdever","@YGrandmontagne","@Mnyo","@EdKOSCIANSKI","@tnoisette","@jankari","@delbello_rom","@rflechaux","@NadiaSorelli","@IT_Digital","@abarbaux","@PhilippeLeroy","@schaptal","@marionspee","@lisavignoli","@ChloeAeberhardt","@MartineJacot","@JuliaPascualita","@curieusedetout","@sgraveleau","@bif_o","@zinebdryef","@apiquard","@pierrehaski","@StephanieDelmas","@Blandine_Garot","@vergara_i","@evan_lebastard","@SophieVclt","@OlivierLevrault","@alicedorgeval","@LouiseMalnoy","@alix_fx","@pierre_baudis","@LucMagoutier","@AgatheMuller","@SGianninelli","@PaulineBoyer33","@NaomiHalll","@romaindlx","@marionbr","@Burtschy","@JacobEtienne","@as_lizzani","@marie_simon","@LaureDaussy","@FabriceAmedeo","@LoubnaChlaikhy","@PlummerWilliam","@OlivierMarin1","@alaurefremont","@mwesfreid","@ChBaDe","@pmathon","@theobaldmarie","@Lnpagesy","@marclandre","@paoliniesther","@Feertchak","@JBLitzler","@GuillaumeErrard","@quentinperinel","@TristanQM","@mlbo","@constancejamet","@LoraTerrazas","@emiliegeffray","@Mathilde_Sd","@CaroPiquet","@DCanivez","@TIM_7375","@blandinelc","@ivanrioufol","@arthurberdah","@SarahLecoeuvre","@guillaume_gui","@DamienMercereau","@W_Chloe","@Assma_MD","@EugenieBastie","@HiTech_lexpress","@bcondominas","@Laurie_Z_","@jeanfrancgerard","@MathieuPagura","@BGUYF","@AlainPiffaretti","@AudreyKucinskas","@julienhory","@Pierrefalga","@TiphThuillier","@cdaniez","@LigerBaptiste","@D_Peras","@julie_dlb","@julian2lamancha","@GaetaneDeljurie","@JulianMattei","@M_Vicuna","@DeBruynOlivier","@Nehed_Jendoubi","@antoine_grenapi","@ColonnaGen","@VictoriaGairin","@Clement_Lacombe","@TVigoureux","@MargauxObriot","@solinedelos","@RocheSabine","@dangerkens","@EdouardDutour","@MDondeyne","@DupuisNathalie1","@bouscarel","@Mathieu2jean","@Sophie_T_J","@laurentcalixte","@patrockwilliams","@PascaleKremer","@AlexJaquin","@LauraIsaaz","@cath_robin","@Del_Gautherin","@Isaduriez","@lucietuile","@AugeyBastien","@mcastagnet","@AminaKalache","@mvaudano","@CParrot","@ombelinetips","@_JoinLion","@BarbolosiRose","@ToiBruno1","@FloraClodic","@xjbdx","@AlexiaEy","@Emjy_STARK","@elcoco01","@rabilebon","@pflovens_","@FabriceFrossard","@MorganeSERRES","@MarjolaineKoch","@edgarsnow","@SRNLF","@CChassigneux","@NassiraELM","@NewsRicard","@Sandreene","@Emilezrt","@Pierre_Do","@Micode","@CColumelli","@DavidAbiker","@ClementBergantz","@benjaminrabier","@celinekallmann","@edwyplenel","@C_Barbier","@JJBourdin_RMC","@LaurenceFerrari","@aslapix","@IsaMillet","@MaximeSwitek","@tomjoubert","@jszanchi","@roqueeva","@XavierBiseul","@florencesantrot","@AntoineCrochet","@freeman59","@MaudeML","@philippe_gulpi","@mathieum76","@kiouari","@imanemoustakir","@BenedicteMallet","@Emilie_Brouze","@antoinebarret","@_nicolasbocquet","@remibuhagiar","@CourretB","@AymericRobert","@miraelmartins","@pmaniere","@jesuisraphk","@David_Ingram","@pcelerier","@technomedia","@Geraldinedauver","@ThierryLabro","@Newsdusud","@nrauline","@gbregeras","@SCouasnonBFM","@actualites_nrv","@dimitrimoulins","@oli_aura","@FabieChiche","@Vincent_Raimblt","@ChristophGreuet","@PAlbuchay","@MarrauddesGrot","@vtalmon","@cedric","@olivierfrigara","@Julien_Jay","@LydiaBerroyer","@Shuua","@datisdaz","@Steuph","@ameliecharnay","@Bruno_LesNums","@LelloucheNico","@CciliaDiQuinzio","@Elodie_C","@SylvRolland","@Kocobe","@FL_Debes","@jdupontcalbo","@GarciaVictor_","@NicoRichaud","@RHoueix","@simottel","@DamienLicata","@annabelle_L","@Lea_Lejeune","@axel_deb","@marin_eben","@ptiberry","@MatthieuDelach","@sandrinecassini","@benjaminferran","@ppgarcia75","@NotPatrick","@ivalerio","@FabienneSchmitt","@alexgoude","@JeromeColombain","@manhack","@Capucine_Cousin","@Fsorel","@oliviertesquet","@marjoriepaillon","@ginades","@PierreTran","@DelphineCuny","@reesmarc","@lauratenoudji","@ldupin","@carolinedescham","@Lucile_Quillet","@cgabizon","@Allocab","@epenser","@JAGventeprivee","@frwrds","@Laure__Bourdon","@Xavier75","@maximeverner","@s_jourdain"]</code></pre>

<p>Ton objectif est de faire un programme qui en prend 5 au hasard, et qui leur tweet une phrase sympa (une blague, un truc qui leur dit que leur dernier article est cool, un remerciement pour leur rôle central dans le fonctionnement de notre démocratie… ce que tu veux !), avec le hashtag <code>#bonjour_monde</code>. Un seul tweet par journaliste suffit (5 tweet en tout donc) pour éviter d'être trop lourd et de te faire bannir de Twitter.</p>

<div class="card box-shadow-0 border-danger">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">⚠️ ALERTE ERREUR COMMUNE</h4>
      <p class="card-text">Twitter est sans pitié et n'hésitera pas à bloquer tes accès si tu fais trop de tweets et mentions aux personnes qui ne te suivent pas. Au-delà de 15-20 tweets, tu risques de te faire ban et être condamné à te tourner les pouces le reste de la journée. Fais des mentions et des tweets avec parcimonie donc 😉</p>
      <p>Si tu te fais bannir, tu vas devoir utiliser les clés d'API de quelqu'un d'autre ou alors c'est la fin du projet pour aujourd'hui…</p>
    </div>
  </div>
</div>

<p>Si tu veux rajouter un petit <code>@the_hacking_pro</code> (référence à notre compte Twitter) dans ton tweet pour les interpeler et nous faire un peu de pub, n'hésite pas 😇 </p>

<h3>2.2. Il va liker bonjour</h3>
<p>Maintenant que tu as dit bonjour à Internet, nous allons te demander de liker les derniers tweets (minimum les 25 derniers) qui ont le hashtag <code>#bonjour_monde</code>. Cela leur donnera une visibilité de malade en créant une grande chaîne de bienveillance 🌈. Pour cela il existe plein de façons possible… nous te laissons le choix !</p>

<h3>2.3. Il va follow bonjour</h3>
<p>Maintenant que tu es la star du like, nous allons te demander de follow les dernières personnes (minimum 20) qui ont tweeté avec le hashtag <code>#bonjour_monde</code>. Idem, cela donnera plein de visibilité et vous serez les stars de Twitter 💙.</p>

<p>Comme toute la communauté THP va jouer avec le hashtag #bonjour_monde, n’hésitez pas à vous rencarder entre vous pour faire buzzer un maximum le hashtag. Tous les coups sont permis, donc amusez-vous bien !</p>

<h3>2.4 Il like et follow en live</h3>
<p>Maintenant tu vas utiliser la fonction <code>Streaming</code> de l'API Twitter afin de réagir en live. Mets en place un robot qui like et follow les comptes tweetant le <code>#bonjour_monde</code> dès l'apparition du Tweet. Pour rendre le programme un peu visuel, n'hésite pas à mettre des <code>puts</code> dès que tu repères un Tweet comme ça (qu'il apparaisse sur ton terminal) ! Et s'ils ne sont pas nombreux, demande à tes potes de Tweeter un peu… mais sans se faire bloquer hein !</p>
<p>Comme il ne réagit qu'en live, ce programme devra tourner en tâche de fond de ton ordinateur.</p>


<h3>2.5. Les tests</h3>
<p>Comme vu lors de la ressource pour le bot Twitter, le testing des tweets va être un petit peu compliqué. Ainsi pour aujourd'hui, on te demandera de ne tester que la méthode de login.</p>

<h2>3. Rendu attendu</h2>
<p>Un repo GitHub d'un bot Twitter faisant les 5 points mentionnés ci-dessus.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>



</div>


  </div>
</div>
    <script src="/packs/dashboard-031178fac0de4f91cbcc.js"></script>
    

    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  </body>
</html>
