<!DOCTYPE html>
<html class="loading" lang="fr">
  <head>
    <meta charset="utf-8">
    <link rel="stylesheet" type="text/css" href="/thp/style/bootstrap.css">
    <title>The hacking project offline</title>
  </head>
  <body class="vertical-layout vertical-menu 2-columns  menu-expanded fixed-navbar" data-open="click" data-menu="vertical-menu" data-color="bg-gradient-x-primary-blue" data-col="2-columns">
      <nav class="navbar navbar-expand-lg navbar-dark bg-primary">
        <h1 class="navbar-brand">THE HACKING PROJECT</h1>
        <button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarColor01" aria-controls="navbarColor01" aria-expanded="false" aria-label="Toggle navigation">
          <span class="navbar-toggler-icon"></span>
        </button>

        <div class="collapse navbar-collapse" id="navbarColor01">
          <ul class="navbar-nav mr-auto">
            <li class="nav-item active">
              <a class="nav-link" href="/thp">Home</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/thp/features">Features</a>
            </li>
            <li class="nav-item">
              <a class="nav-link" href="/thp/about">About</a>
            </li>
          </ul>
          <form class="form-inline my-2 my-lg-0">
            <input class="form-control mr-sm-2" type="text" placeholder="Search">
            <button class="btn btn-secondary my-2 my-sm-0" type="submit">Search</button>
          </form>
        </div>
      </nav>
<a type="button" class="btn btn-primary" href="/thp/semaine_2/">Semaine 2</a>

<div class="app-content content">
  <div class="content-wrapper">
    <div class="content-wrapper-before"></div>
    <div class="content-header row"></div>
    
      <div class="container">
    <div class="card">
  <div class="card-header">
    <h4 class="text-center"> Programme jour par jour</h4>
  </div>
  <div class="card-body">
    <div class="text-center">
    <a href="/thp/semaine_1">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
        <i class="fa fa-terminal"></i>&nbsp;&nbsp;&nbsp;Lun
      </button>
</a>    <a href="/thp/semaine_1/jour_2">
      <button class="btn btn-secondary btn-outline-dark btn-lg mr-4">
        <i class="fa fa-code"></i>&nbsp;&nbsp;&nbsp;Mar
      </button>
</a>    <a href="/thp/semaine_1/jour_3">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
        <i class="fa fa-desktop"></i>&nbsp;&nbsp;&nbsp;Mer
      </button>
</a>    <a href="/thp/semaine_1/jour_4">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
      <i class="fa fa-folder-open"></i>&nbsp;&nbsp;&nbsp;Jeu
      </button>
</a>    <a href="/thp/semaine_1/jour_5">
      <button class="btn btn-secondary btn-outline-dark btn mr-4">
      <i class="fa fa-bullhorn"></i>&nbsp;&nbsp;&nbsp;Ven
      </button>
</a>    </div>
  </div>
</div>

<div class="app-content content">
  <div class="content-wrapper">
    <div class="content-wrapper-before"></div>
    <div class="content-header row"></div>
    
      
<div class="content-body">
      <h2 class="text-center">Jouer avec des excels</h2>
      <h4 class="text-center">Programmation OrientÃ©e Objet</h4>
  <div class="row">
     <div class="col-xl-3 col-lg-6 col-md-12">
  <div class="card">
    <div class="card-content">
      <div class="card-body">
        <div class="media d-flex">
          <div class="align-self-top">
              <i class="ft-calendar icon-opacity info font-large-4"></i>
          </div>
          <div class="media-body text-right align-self-bottom mt-3">
              <span class="d-block mb-1 font-medium-1"></span>
              <h3 class="info mb-0">
                 Jour 24 / 55</h3>
          </div>
        </div>
        <div class="progress progress-sm mt-1 mb-0 box-shadow-2">
            <div class="progress-bar bg-gradient-x-info" role="progressbar" style="width: 43%" aria-valuenow="25" aria-valuemin="0" aria-valuemax="120">
            </div>
        </div>
      </div>
    </div>
  </div>
 </div>


    <div class="col-xl-3 col-lg-6 col-md-12">
  <div class="card">
    <div class="card-content">
      <div class="card-body">
        <div class="media d-flex">
          <div class="align-self-top">
            <i class="ft-heart icon-opacity danger font-large-4"></i>
          </div>
          <div class="media-body text-right align-self-bottom mt-3">
            <span class="d-block mb-1 font-medium-1">Jokers restant</span>
            <h3 class="danger mb-0">
                3
            </h3>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

    <div class="col-xl-3 col-lg-6 col-md-12">
    <div class="card">
        <div class="card-content">
            <div class="card-body">
                <div class="media d-flex">
                    <div class="align-self-top">
                        <a href="/dashboard/assignments?locale=fr">
                           <i class="ft-fast-forward icon-opacity warning font-large-4"></i>
</a>                    </div>
                    <div class="media-body text-right align-self-bottom mt-3">
                        <span class="d-block mb-1 font-medium-1">Missions</span>
                            <div class="badge border-danger danger badge-border">Pas inscrit</div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

  </div>
  <div class="row">
        <div class="container">
    <div class="col-xl-12 col-lg-12 col-md-12">
    <div class="card">
        <div class="card-header">
        <h1 >Programmation OrientÃ©e Objet
                <i class="fa fa-space-shuttle text-danger"></i>
        </h1>
        
        </div>
        <div class="card-content">
        <div class="card-body">
            <div class="card-text">
            <h2 class="text-center">Jouer avec des excels</h2>
            <div class="cd-horizontal-timeline loaded">
                <div class="timeline">
                <div class="events-wrapper">
                    <div class="events" style="width: 1800px;">
                    <ol>
                                <li>
                                    <a style="left:120px;" href="/dashboard/weeks/3/days/1?locale=fr">
                                        Lun
                                            <i class="fa fa-beer text-warning" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Rendez-vous pour boire un coup"></i>

</a>                                </li>
                            <li>
                                <a class="selected" style="left:240px;" data-toggle="tooltip" data-placement="top" title="Jouer avec des excels" href="/dashboard/weeks/3/days/2?locale=fr">
                                    Mar
                                        <i class="fa fa-rocket text-danger" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Projet Ã  rendre ce jour-lÃ "></i>

</a>                                </li>
                                <li>
                                    <a style="left:360px;" href="/dashboard/weeks/3/days/3?locale=fr">
                                        Mer
                                            <i class="fa fa-pencil text-success" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Corrections cette journÃ©e lÃ " ></i>


</a>                                </li>
                                <li>
                                    <a style="left:480px;" href="/dashboard/weeks/3/days/4?locale=fr">
                                        Jeu
                                            <i class="fa fa-rocket text-danger" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Projet Ã  rendre ce jour-lÃ "></i>

</a>                                </li>
                                <li>
                                    <a style="left:600px;" href="/dashboard/weeks/3/days/5?locale=fr">
                                        Ven
                                            <i class="fa fa-pencil text-success" aria-hidden="true" data-toggle="tooltip" data-placement="bottom" title="Corrections cette journÃ©e lÃ " ></i>


</a>                                </li>
                    </ol>
                </div>
                </div>
            </div>
            </div>
        </div>
        </div>
    </div>
    </div>
<div>
  </div>

  <!-- Les fameuses corrections qui n'arrivnet que les jours concernÃ©s -->


    <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Un dossier Ruby bien rangÃ©</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>Quand on fait de la programmation, il faut un dossier bien rangÃ©, des programmes qui appellent les bons. Ainsi les gens qui dÃ©barquent dans ton dossier ne seront pas perdus. Dans cette ressource nous allons voir comment bien ranger un dossier.</p>

<p>Arriver dans un repo oÃ¹ y'a des fichiers partout et oÃ¹ c'est le bordel, cela ne fait jamais plaisirÂ : la personne ne comprend rien, et il faut passer plus de temps Ã  expliquer son programme qu'Ã  le modifier. Ainsi, Ruby a une convention qui permet d'organiser la structure d'un dossier Ruby.</p>


<h2>2. Historique</h2>
<p>Ã‰tant donnÃ© que dans la POO il y a des milliers de fichiers dans tous les sens, on a rapidement commencÃ© Ã  tout bien ranger.</p>

<h2>3. La ressource</h2>



<h3>3.1. Structure de dossier conventionnelle</h3>

<p>Imaginons que tu veuilles faire un programme qui scrappe des donnÃ©es et qui les enregistre sur un fichier CSV. Voyons la structure suivante :</p>

<pre><code class="language-shell">scrapper
â”‚
â”œâ”€â”€ .gitignore
â”œâ”€â”€ README.md
â”œâ”€â”€ Gemfile
â”œâ”€â”€ Gemfile.lock
â”œâ”€â”€ data.csv
â””â”€â”€ scrap.rb</code></pre>


<p>En soi, elle est Ã  peu prÃ¨s lisible, mais elle partira dans le grand n'importe quoi dÃ¨s que tu veux ajouter des fonctionnalitÃ©s (et donc des classes, et donc des fichiers) dans ton application. Et nous n'avons mÃªme pas mis les fichiers de test, indispensables pour toute application moderne. Ainsi, nous allons te montrer une structure bien plus organisÃ©e. Aucune surprise pour toi, c'est celle qu'on utilise jusque-lÃ Â : </p>


<pre><code class="language-shell">mon_projet
â”œâ”€â”€ lib
â”‚   â””â”€â”€ scrapper.rb
â”œâ”€â”€ db
â”‚   â””â”€â”€ thing.csv
â”œâ”€â”€ spec
â”‚   â”œâ”€â”€ spec_helper.rb
â”‚   â””â”€â”€ scrapper_spec.rb
â”œâ”€â”€ app.rb
â”œâ”€â”€ README.md
â”œâ”€â”€ Gemfile
â”œâ”€â”€ Gemfile.lock
â”œâ”€â”€ Autres fichiers (.env, .gitignore)
â””â”€â”€ .rspec</code></pre>



<p>L'objectif est d'avoir juste Ã  faire <code>$ bundle install</code> et <code>$ ruby app.rb</code> quand on arrive dans le dossier, pour faire tourner l'application. Chaque fichier doit avoir une fonction unique et prÃ©cise, reprÃ©sentÃ©e par une classe. Ainsi, notre fichier <code>scrapper.rb</code> doit coder la classe <code>Scrapper</code>, qui a pour fonction de rÃ©cupÃ©rer des donnÃ©es. Ainsi, il suffit d'appeler <code>Scrapper.new.perform</code> dans notre fichier <code>app.rb</code> pour que tout fonctionne.</p>

<p>Cette convention est beaucoup plus lisible, et permet de bien comprendre ce que fait l'application.</p>

<h3>3.2. Quelques rÃ©glages</h3>
<p>Afin de faire marcher le dossier, il y a bien entendu quelques rÃ©glages Ã  faire. DÃ©jÃ , il faut brancher le Bundler au fichier <code>app.rb</code> : </p>

<pre><code class="language-ruby">require 'bundler'
Bundler.require</code></pre>


<div class="card box-shadow-0 border-info">
  <div class="card-content collapse show">
    <div class="card-body">
      <h4 class="card-title">ðŸš€ ALERTE BONNE ASTUCE</h4>
        <p>Ajouter ces deux lignes en tout dÃ©but de programme <code>app.rb</code>Â : </p>        
        <pre><code class="language-ruby">require 'bundler'
Bundler.require</code></pre>
        <p>Permet de dire Ã  Ruby "hey, fais un require sur toutes les gems de mon Gemfile STP, comme Ã§a, Ã§a m'Ã©vitera de les appeler tous les deux fichiers". Une commande trÃ¨s pratique pour Ã©viter des longues listes de <code>require</code> en haut de chaque classe. Seul un bon vieux <code>$ bundle install</code> suffira dans le terminal.</p>
        <p>=> GrÃ¢ce Ã  ces deux lignes en en-tÃªte du fichier Ã  exÃ©cuter (<code>ruby app.rb</code>), les require de gems deviennent inutiles. Il suffit que ton Gemfile soit bien complÃ©tÃ©.</p>
    </div>
  </div>
</div>


<p>Ensuite, il faut mettre les bons require au bon endroit pour que les fichiers s'appellent entre eux. On pourrait mettre des lignes comme celles-ci :</p>

<pre><code class="language-ruby">require 'lib/my_folder/file'
require 'lib/scrapper'
etc</code></pre>

<p>Mais cette technique manque un chouÃ¯a d'Ã©lÃ©gance, on peut dire facilement Ã  Ruby "hey, tout ce qui est dans le dossier ou dans un sous-dossier de <code>lib</code>, mets-les dans le PATH comme Ã§a j'aurai juste besoin de faire <code>require 'NomDeClass'</code> sans me taper tout le chemin-dossier du fichier". <br>
C'est possible avec la ligneÂ : <code>$:.unshift File.expand_path("./../lib", __FILE__)</code>. Tu peux en lire plus sur cette mÃ©thode <a href="https://stackoverflow.com/questions/4474918/file-expand-path-gemfile-file-how-does-this-work-where-is-the-fil"> dans la premiÃ¨re rÃ©ponse ici</a>. Ainsi, les lignes de require vont ressembler Ã  ceci :</p>

<pre><code class="language-ruby">$:.unshift File.expand_path("./../lib", __FILE__)
require 'scrapper' #plus besoin de prÃ©ciser le path exact</code></pre>

<p>Et puis enfin, tu as juste Ã  appeler la classe qui t'intÃ©resse avec <code>MyClass.new.perform</code>. Ainsi, ton fichier <code>app.rb</code> va ressembler Ã  ceci :</p>

<pre><code class="language-ruby">require 'bundler'
Bundler.require

$:.unshift File.expand_path("./../lib", __FILE__)
require 'scrapper'

MyClass.new.perform</code></pre>

<p>Et lÃ , tu as un dossier qui ressemble Ã  quelque chose pour ton application.</p>


<h3>3.3. Et si mon app fait plusieurs choses Ã  la foisÂ ?</h3>
<p>C'est une excellente question. Prenons l'exemple d'une application qui rÃ©cupÃ¨re des e-mails, qui les enregistre, et qui envoie des e-mails Ã  partir d'un fichier CSV. Tu n'as peut-Ãªtre pas envie que ton application fasse tout Ã  la fois quand tu exÃ©cutes le fichier <code>app.rb</code>, ainsi, ce fichier va te servir de chef d'orchestre, et alterner entre les diffÃ©rents services de ton application. L'application tournera en boucle (jusqu'Ã  ce que l'utilisateur fasse <code>CTRL</code> + <code>C</code>) et appellera les bonnes classes en fonction des inputs de l'utilisateur.</p>

<p>Par exemple, l'application Ã  son dÃ©marrage, va appeler la classe <code>Index</code>, qui a pour but de demander ce que l'utilisateur veut faire. En fonction de son input, elle appellera la bonne classe (<code>Scrapper</code>, <code>EmailSender</code>, etc), puis elle affichera la classe <code>Done</code>, qui dira "Hey, c'est terminÃ©Â !". Et elle demandera Ã  l'utilisateur ce qu'il veut faire.</p>

<p>Les classes <code>Index</code> et <code>Done</code> sont des classes qui ont pour but unique dâ€™interagir avec l'utilisateur en lui donnant une interface visuelle. Par convention, nous appelons ces classes des <b>views</b>, qui seront rangÃ©es dans un dossier du mÃªme nom. Ainsi, notre dossier ressemblera Ã  ceci :</p>


<pre><code class="language-shell">mon_projet
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ app
â”‚   â”‚   â”œâ”€â”€ scrapper.rb
â”‚   â”‚   â””â”€â”€ email_sender.rb
â”‚   â””â”€â”€ views
â”‚       â”œâ”€â”€ done.rb
â”‚       â””â”€â”€ index.rb
â”œâ”€â”€ db
â”‚   â””â”€â”€ thing.csv
â”œâ”€â”€ spec
â”‚   â”œâ”€â”€ spec_helper.rb
â”‚   â””â”€â”€ scrapper_spec.rb
â”œâ”€â”€ app.rb
â”œâ”€â”€ README.md
â”œâ”€â”€ Gemfile
â”œâ”€â”€ Gemfile.lock
â”œâ”€â”€ Autres fichiers (.env, .gitignore)
â””â”€â”€ .rspec</code></pre>


<p>L'avantage de ce type de structure est que tes programmes sont rangÃ©s dans des dossiers qui indiquent dÃ©jÃ  leur utilitÃ©Â : base de donnÃ©eÂ ? GÃ©nÃ©rateur de vue pour l'utilisateurÂ ? Classe apportant une fonction prÃ©ciseÂ ?<br>
Souviens-toi qu'il est prÃ©fÃ©rable d'avoir 100 fichiers qui font 5 lignes mais rangÃ©s de faÃ§on structurÃ©e, qu'un seul fichier avec 500 lignes.</p>

<p>Nous verrons tout ceci plus en dÃ©tails lors du cours sur le MVC, un modÃ¨le d'architecture logicielle trÃ¨s connu et sur lequel se base Rails.</p>



<h2>4. Points importants Ã  retenir</h2>
<p>Voici un bon exemple d'architecture logicielle Ruby :</p>

<pre><code class="language-shell">mon_projet
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ app
â”‚   â”‚   â”œâ”€â”€ scrapper.rb
â”‚   â”‚   â””â”€â”€ email_sender.rb
â”‚   â””â”€â”€ views
â”‚       â”œâ”€â”€ done.rb
â”‚       â””â”€â”€ index.rb
â”œâ”€â”€ db
â”‚   â””â”€â”€ thing.csv
â”œâ”€â”€ spec
â”‚   â”œâ”€â”€ spec_helper.rb
â”‚   â””â”€â”€ scrapper_spec.rb
â”œâ”€â”€ app.rb
â”œâ”€â”€ README.md
â”œâ”€â”€ Gemfile
â”œâ”€â”€ Gemfile.lock
â”œâ”€â”€ Autres fichiers (.env, .gitignore)
â””â”€â”€ .rspec</code></pre>

<p>Une telle application doit pouvoir se lancer en faisant seulement <code>$ ruby app.rb</code></p>
<p>Les lignes suivantes dans app.rb vont te permettre d'Ã©viter les require de gem : </p>

<pre><code class="language-ruby">require 'bundler'
Bundler.require</code></pre>

<p>Les lignes suivantes dans app.rb vont te permettre d'appeler facilement les autres fichiers de classe</p>
<pre><code class="language-ruby">$:.unshift File.expand_path("./../lib", __FILE__)
require 'app/fichier_1'
require 'views/fichier_2'</code></pre>



<h2>5. Pour aller plus loin</h2>
<p>Pas besoin pour le moment.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>

  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #5E66E5 " >
          <h1>Cours : Enregistrer ses donnÃ©es dans un fichier qui gÃ¨re les tableaux</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>Prenons l'exemple de ton scrappeurÂ : Ã  chaque fois que tu le lances, ce dernier n'enregistre pas les donnÃ©es quelque part, et ces derniÃ¨res sont perdues Ã  tout jamais lorsque tu fermes ton terminal. Et si l'on t'apprenait Ã  enregistrer des donnÃ©es dans un fichierÂ ?</p>

<p>Dans cette ressource nous allons te montrer trois formats trÃ¨s cools pour le stockage de donnÃ©es :</p>

<ul>
  <li>le format JSON, trÃ¨s rÃ©pandu sur le Web,</li>
  <li>les fichier Google Spreadsheet, pour t'aider Ã  t'automatiser des tÃ¢ches en conjugant Ruby et Spreadsheet,</li>
  <li>le format CSV, trÃ¨s connu aussi pour les donnÃ©es.</li>
</ul>

<h2>2. Historique</h2>
<p>Heu..</p>


<h2>3. La ressource</h2>
<h3>3.1. JSON</h3>
<p>Le format JSON est un format de fichier qui permet de sauvegarder, pour rÃ©utiliser plus tard, des donnÃ©es telles que des hash, ou des arrays. JSON a l'avantage d'Ãªtre lisible par un humain, et par tout langage de programmation. <a href="https://www.w3schools.com/js/js_json_intro.asp" target="_blank">W3Schools a fait un rapide rÃ©cap</a> Ã  ce sujet</p>

<p>DÃ©couvre comment lire un fichier JSON avec <a href="https://www.tutorialspoint.com/json/json_ruby_example.htm" target="_blank" >ce tutoriel sympathique</a>. Enfin, <a href="https://stackoverflow.com/a/5507535/8564105" target="_blank" >cette rÃ©ponse</a> mentionne comment Ã©crire un fichier JSON Ã  partir d'un objet Ruby.</p>

<h3>3.2. Google Spreadsheet</h3>

<p>Commence par dÃ©couvrir la <a href="https://github.com/gimite/google-drive-ruby" target="_blank">gem google_drive</a> de Ruby. Puis essaie de suivre la partie <i>How to use</i>, notamment la sous-partie <a href="https://github.com/gimite/google-drive-ruby#example-to-readwrite-spreadsheets" target="_blank">Example to read/write spreadsheets</a>, pour faire marcher ton premier fichier spreadsheet.</p>

<p>La premiÃ¨re fois que l'on se branche Ã  l'API de Google Drive, on se butte au fait qu'elle n'est pas simple Ã  gÃ©rer. Heureusement, les gens de la gem ont alimentÃ© leur doc avec <a href="https://github.com/gimite/google-drive-ruby/blob/master/doc/authorization.md" target="_blank">un tutoriel sur comment se brancher Ã  l'API de Google Drive</a>. Suis-le donc ðŸ˜‰</p>

<h3>3.3. CSV</h3>
<p>CSV signifie "Comma-Separated Values" ou "Valeur SÃ©parÃ©es par une Virgule". Ce format est trÃ¨s populaire pour reprÃ©senter des tableaux : chaque ligne du CSV est une ligne de tableau, et chaque contenue d'une colonne est sÃ©parÃ© par une virgule. Au final, un fichier CSV ressemble Ã  ceci :</p>

<pre><code class="language-csv">1,chocolate,brown
2,bacon,pink
3,apple,red
4,banana,yellow
5,almonds,brown</code></pre>
<p>Ici les 3 colonnes pourraient avoir pour titre "Line number", "Food" et "Color". </p>

<p>RubyGuides ont fait <a href="https://www.rubyguides.com/2018/10/parse-csv-ruby/" target="_blank">un chouette tutoriel</a> qui t'explique comment interagir avec un fichier CSV. Comme tu peux le voir, CSV est intÃ©grÃ© Ã  Ruby, tu peux donc <a href="https://ruby-doc.org/stdlib-2.0.0/libdoc/csv/rdoc/CSV.html" target="_blank">lire la doc</a> qui te donnera toutes les mÃ©thodes pour jouer avec des CSV.</p>

<h2>4. Points importants Ã  retenir</h2>
<p>Tu as vu trois faÃ§ons de sauvegarder des tableaux de faÃ§on pÃ©renne :</p>

<ul>
  <li>JSON</li>
  <li>Google Spreadsheet</li>
  <li>CSV</li>
</ul>

<h2>5. Pour aller plus loin</h2>
<p>Avec Ruby les possibilitÃ©s sont Ã©normes, mais dÃ©jÃ  c'est pas mal lÃ . On verra les bases de donnÃ©es (qui ne sont que des gros tableaux finalement) la semaine prochaine.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>


  <div class="container">
  <div class="row">
    <div class="col-12">
      <div class="card">
        <div class="card-header" style="border-top: 3px solid #FF4081 " >
          <h1>Projet : Sauvegarder des donnÃ©es en masse</h1>
          <a class="heading-elements-toggle">
          <i class="la la-ellipsis-v font-medium-3"></i>
          </a>
          <div class="heading-elements">
            <ul class="list-inline mb-0">
              <li><a data-action="collapse"><i class="ft-minus"></i></a></li>
              <li><a data-action="expand"><i class="ft-maximize"></i></a></li>
            </ul>
          </div> 
      </div>
      <div class="card-content collapse show">
        <div class="card-body">
          <div class="tab-pane active" id="home1" role="tabpanel">
          <h2>1. Introduction</h2>
<p>Ensemble, nous allons sauvegarder tout un tas de donnÃ©es dans une base sous la forme d'une spreadsheet, d'un CSV ou d'un JSON. Tous les programmes du jour devront Ãªtre faits en POOÂ : tout doit Ãªtre contenu dans des classes, 1 classe par fichier. Finis les petits programmes faits Ã  la va-vite.</p>



<h2>2. Le projet</h2>
<p>Note pour les testsÂ : aujourd'hui exceptionnellement pas de test â˜º</p>
<p>Le projet du jour a pour but d'enregistrer dans 3 formats diffÃ©rents les e-mails du Val d'Oise (tu te rappelles bien sÃ»r de ce projet, heinÂ ?). Pour ce faire, reprends le programme que tu avais fait prÃ©cÃ©demment et mets dans une belle classe. Bien entendu (et cela vaudra pour TOUS les projets Ã  venir), ton programme sera inclus dans un dossier bien structurÃ©.</p>
<p>A chaque format, tu vas crÃ©er une mÃ©thode spÃ©cifique pour enregistrer le rÃ©sultat de ton scrappeur.</p>

<h3>2.1. Enregistrer dans un JSON</h3>
<p>Tu voudrais Ã©viter de faire tourner ton scrappeur Ã  chaque fois que tu reboots ton ordiÂ : il faut en sauvegarder les donnÃ©esÂ ! JSON Ã©tant un format standard, tu dÃ©cides de le faire sous un fichier <code>emails.JSON</code>.</p>
<p>CrÃ©Ã© une mÃ©thode <code>save_as_JSON</code> qui prend le rÃ©sultat de ton scrapper et enregistre dans ton ordi les emails du Val d'Oise. Si tu as enregistrÃ© le rÃ©sultat de ton scrapping au format suivant : <code>{"ABLEIGES"=&gt;"mairie.ableiges95@wanadoo.fr", "AINCOURT"=&gt;"mairie.aincourt@wanadoo.fr", etc }</code>, il te faut passer sur chaque couple clÃ©-valeur du hash. Ã€ chaque passage, tu vas ajouter du contenu dans ton fichier JSON.</p>

<p>On te laisse utiliser les ressources du jour pour produire un joli JSON.</p>


<h3>2.2. Google Spreadsheet</h3>

<p>Ã€ prÃ©sent, c'est le CEO de Get-Email Corp qui voudrait que tu puisses lui envoyer tes rÃ©sultats par e-mail. Cependant, ce dernier est un peu old schoolÂ : il ne comprend pas comment obtenir la liste dâ€™e-mails Ã  partir d'un fichier <em>scrapping.rb</em>, ne pige rien au format JSON et refuse de suivre The Hacking Project. Comme le client est roi, la seule faÃ§on de lui fournir ces e-mails est de le faire via un fichier Google Spreadsheet. Ta mission est donc de trouver un moyen de faire un fichier Google Spreadsheet qui contienne en <em>colonne A</em> les noms des villes, et en <em>colonne B</em> les e-mails des dites mairies.</p>

<p>Nous te conseillons de travailler sur un fichier spreadsheet que tu vas crÃ©er pour l'occasion. <a href="https://github.com/gimite/google-drive-ruby#example-to-readwrite-spreadsheets" target="_blank" class="text-primary">Ces quelques lignes de code</a> t'indiquent comment ouvrir un spreadsheet Ã  partir de Ruby.</p>

<p>Tout ce travail de sauvegarde se fera via une mÃ©thode <code>save_as_spreadsheet</code></p>

<h3>2.2. Enregistrer dans un CSV</h3>

<p>Une fois le rÃ©sultat livrÃ© Ã  Get-Email Corp, tu te sens l'Ã¢me d'un Julien Assange et tu veux balancer le fichier sur jeux-video.com. La communautÃ© t'incite fortement Ã  le faire en CSV (et toi, t'es trÃ¨s sensible Ã  ce que la communautÃ© veut).</p>

<p>Enregistre maintenant les donnÃ©es dans un CSV grÃ¢ce Ã  une mÃ©thode <code>save_as_csv</code></p>


<h2>3. Rendu attendu</h2>
<p>Un dossier qui scrappe les mairies et qui les enregistre dans les trois types vus aujourd'hui. La structure devrait ressembler Ã  ceci :</p>

<pre><code class="language-shell">mon_projet
â”œâ”€â”€ lib
â”‚   â”œâ”€â”€ app
â”‚   â”‚   â””â”€â”€ scrapper.rb
â”œâ”€â”€ db
â”‚   â””â”€â”€ emails.csv
â”‚   â””â”€â”€ emails.json
â”œâ”€â”€ spec
â”‚   â”œâ”€â”€ spec_helper.rb
â”‚   â””â”€â”€ scrapper_spec.rb
â”œâ”€â”€ app.rb
â”œâ”€â”€ README.md
â”œâ”€â”€ Gemfile
â”œâ”€â”€ Gemfile.lock
â”œâ”€â”€ Autres fichiers (.env, .gitignore)
â””â”€â”€ .rspec</code></pre>

<p>Tu peux rajouter un petit menu si tu veux pour laisser le choix du format-cible Ã  l'utilisateur.</p>
          </div>
        </div>
        </div>
      </div>
    </div>
  </div>
</div>



</div>


  </div>
</div>
    <script src="/packs/dashboard-031178fac0de4f91cbcc.js"></script>
    

    <script charset="utf-8">
      $('input[name=authenticity_token]').val($('meta[name=csrf-token]').attr('content'));
    </script>

  </body>
</html>
